"CON-BF"= "CON-BF",
"CON-FF" = "CON-FF",
"AB-BF"= "AB-BF",
"AB-FF"= "AB-FF"
)) %>%
mutate(values_adjusted = if_else(tissue == "ileum", values/tissue_weight_mg, values)) %>% #Adjust for tissue weight
pivot_wider(
id_cols = c(
sample_id,exp_number, group, received_antibiotics,maternal_treatment, tissue,tissue_weight_mg, values),
names_from = variables,
values_from = values_adjusted)
#____Pivot longer____
cytokines_long <- cytokines_adjusted %>%
pivot_longer(.,
cols = INFg:TNFa ,
names_to = "variables",
values_to = "values_adjusted"
)
View(cytokines_long)
# Import dataset
cytokines <- read_excel("data/processed/cytokines.xlsx")
glimpse(cytokines)
View(cytokines)
glimpse(cytokines)
library(readxl)
library(tidyverse)
library(gt)
library(gtsummary)
library(broom)
library(rstatix)
library(knitr)
library(patchwork)
library(ggpubr)
# Import dataset
cytokines <- read_excel("data/processed/cytokines.xlsx")
library(readxl)
library(tidyverse)
library(gt)
library(gtsummary)
library(broom)
library(rstatix)
library(knitr)
library(patchwork)
library(ggpubr)
# Import dataset
cytokines <- read_excel("data/processed/cytokines.xlsx")
glimpse(cytokines)
View(cytokines)
cytokines %>%
filter(tissue == "ileum")
cytokines %>%
filter(tissue == "ileum") %>%
filter(exp_number == "1")
cytokines %>%
filter(tissue == "ileum") %>%
filter(exp_number == "1") %>%
ggplot(aes(group, tissue_weight_mg)) +
geom_histogram()
cytokines %>%
filter(tissue == "ileum") %>%
filter(exp_number == "1") %>%
ggplot(aes(tissue_weight_mg)) +
geom_histogram()
cytokines %>%
filter(tissue == "ileum") %>%
filter(exp_number == "1") %>%
ggplot(aes(tissue_weight_mg, group = group)) +
geom_histogram()
cytokines %>%
filter(tissue == "ileum") %>%
filter(exp_number == "1") %>%
ggplot(aes(x = tissue_weight_mg, fill = group)) +
geom_density()
cytokines %>%
filter(tissue == "ileum") %>%
filter(exp_number == "1") %>%
ggplot(aes(x = tissue_weight_mg, fill = group)) +
geom_density() +
facet_wrap(~ group,
scales = "free")
cytokines %>%
filter(tissue == "ileum") %>%
filter(exp_number == "1") %>%
ggplot(aes(x = group, y = tissue_weight_mg, fill = group)) +
geom_boxplot() +
facet_wrap(~ group,
scales = "free")
cytokines %>%
filter(tissue == "ileum") %>%
filter(exp_number == "1") %>%
ggplot(aes(x = group, y = tissue_weight_mg, fill = group)) +
geom_boxplot()
cytokines %>%
filter(tissue == "ileum") %>%
filter(exp_number == "1") %>%
ggplot(aes(x = group, y = tissue_weight_mg, fill = group)) +
geom_boxplot() +
geom_jitter()
cytokines %>%
filter(tissue == "ileum") %>%
filter(exp_number == "1") %>%
ggplot(aes(x = group, y = tissue_weight_mg, fill = group)) +
geom_boxplot() +
geom_point()
cytokines %>%
filter(tissue == "ileum") %>%
filter(exp_number == "1") %>%
ggplot(aes(x = group, y = tissue_weight_mg, fill = group)) +
geom_boxplot() +
geom_point(position = "dodge")
cytokines %>%
filter(tissue == "ileum") %>%
filter(exp_number == "1") %>%
ggplot(aes(x = group, y = tissue_weight_mg, fill = group)) +
geom_boxplot() +
geom_point(position = dodge)
cytokines %>%
filter(tissue == "ileum") %>%
filter(exp_number == "1") %>%
ggplot(aes(x = group, y = tissue_weight_mg, fill = group)) +
geom_boxplot() +
geom_point(position = "dodge")
cytokines %>%
filter(tissue == "ileum") %>%
filter(exp_number == "1") %>%
ggplot(aes(x = group, y = tissue_weight_mg, fill = group)) +
geom_boxplot() +
geom_point(position_dodge(width = 2))
cytokines %>%
filter(tissue == "ileum") %>%
filter(exp_number == "1") %>%
ggplot(aes(x = group, y = tissue_weight_mg, fill = group)) +
geom_boxplot() +
geom_point(position_dodge(width = 1))
cytokines %>%
filter(tissue == "ileum") %>%
filter(exp_number == "1") %>%
ggplot(aes(x = group, y = tissue_weight_mg, fill = group)) +
geom_boxplot() +
geom_point(position_dodge())
cytokines %>%
filter(tissue == "ileum") %>%
filter(exp_number == "1") %>%
ggplot(aes(x = group, y = tissue_weight_mg, fill = group)) +
geom_boxplot() +
geom_point()
cytokines %>%
filter(tissue == "ileum") %>%
filter(exp_number == "1") %>%
ggplot(aes(x = tissue_weight_mg, fill = group)) +
geom_density() +
facet_wrap(~ group,
scales = "free")
cytokines %>%
filter(tissue == "ileum") %>%
filter(exp_number == "1") %>%
ggplot(aes(x = group, y = tissue_weight_mg, fill = group)) +
geom_boxplot() +
geom_point()
cytokines %>%
filter(tissue == "ileum") %>%
filter(exp_number == "1") %>%
group_by(group) %>%
summarize(mean = mean(tissue_weight_mg),
sd = sd(tissue_weight_mg))
cytokines %>%
filter(tissue == "ileum") %>%
filter(exp_number == "1") %>%
group_by(group) %>%
summarize(mean = mean(tissue_weight_mg),
media = median(tissue_weight_mg)
sd = sd(tissue_weight_mg),
cytokines %>%
filter(tissue == "ileum") %>%
filter(exp_number == "1") %>%
group_by(group) %>%
summarize(mean = mean(tissue_weight_mg),
media = median(tissue_weight_mg),
sd = sd(tissue_weight_mg),
normality = shapiro_test(tissue_weight_mg))
tbl_tissue_exp1 <- cytokines %>%
filter(tissue == "ileum") %>%
filter(exp_number == "1") %>%
group_by(group) %>%
summarize(mean = mean(tissue_weight_mg),
media = median(tissue_weight_mg),
sd = sd(tissue_weight_mg),
normality = shapiro_test(tissue_weight_mg))
kable(tbl_tissue_exp1)
tbl_tissue_exp1 <- cytokines %>%
filter(tissue == "ileum") %>%
filter(exp_number == "1") %>%
group_by(group) %>%
summarize(mean = mean(tissue_weight_mg),
media = median(tissue_weight_mg),
sd = sd(tissue_weight_mg),
normality = shapiro_test(tissue_weight_mg))
tbl_tissue_exp1
select(group:sd,normality$p.value)
select(group, mean, media, sd,normality$p.value)
tbl_tissue_exp1 <- cytokines %>%
filter(tissue == "ileum") %>%
filter(exp_number == "1") %>%
group_by(group) %>%
summarize(mean = mean(tissue_weight_mg),
media = median(tissue_weight_mg),
sd = sd(tissue_weight_mg),
normality = shapiro_test(tissue_weight_mg))
tbl_tissue_exp1 <- cytokines %>%
filter(tissue == "ileum") %>%
filter(exp_number == "1") %>%
group_by(group) %>%
summarize(mean = mean(tissue_weight_mg),
media = median(tissue_weight_mg),
sd = sd(tissue_weight_mg),
normality = shapiro_test(tissue_weight_mg))
cytokines %>%
filter(tissue == "ileum") %>%
filter(exp_number == "1") %>%
group_by(group) %>%
summarize(mean = mean(tissue_weight_mg),
media = median(tissue_weight_mg),
sd = sd(tissue_weight_mg),
normality = shapiro_test(tissue_weight_mg))
tbl_tissue_exp1$normality$p.value
cytokines %>%
filter(tissue == "ileum") %>%
filter(exp_number == "1") %>%
group_by(group) %>%
summarize(mean = mean(tissue_weight_mg),
media = median(tissue_weight_mg),
sd = sd(tissue_weight_mg),
normality = shapiro_test(tissue_weight_mg)) %>%
select(tbl_tissue_exp1$group:sd)
cytokines %>%
filter(tissue == "ileum") %>%
filter(exp_number == "1") %>%
group_by(group) %>%
summarize(mean = mean(tissue_weight_mg),
media = median(tissue_weight_mg),
sd = sd(tissue_weight_mg),
normality = shapiro_test(tissue_weight_mg)) %>%
select(group:sd)
tbl_tissue_exp1 <- cytokines %>%
filter(tissue == "ileum") %>%
filter(exp_number == "1") %>%
group_by(group) %>%
summarize(mean = mean(tissue_weight_mg),
media = median(tissue_weight_mg),
sd = sd(tissue_weight_mg),
normality = shapiro_test(tissue_weight_mg))
tbl_tissue_exp1 %>%
select(group,sd,media)
tbl_tissue_exp1 %>%
select(group,sd,media, tbl_tissue_exp1$normality$p.value)
tbl_tissue_exp1 %>%
select(group,sd,media, normality$p.value)
tbl_tissue_exp1 %>%
select(group,sd,media, p.value)
tbl_tissue_exp1 <- cytokines %>%
filter(tissue == "ileum") %>%
filter(exp_number == "1") %>%
group_by(group) %>%
summarize(mean = mean(tissue_weight_mg),
media = median(tissue_weight_mg),
sd = sd(tissue_weight_mg),
normality = shapiro_test(tissue_weight_mg)) %>%
kable()
normality = shapiro_test(tissue_weight_mg) %>% select(p.value)
cytokines %>%
filter(tissue == "ileum") %>%
filter(exp_number == "1") %>%
group_by(group) %>%
summarize(mean = mean(tissue_weight_mg),
media = median(tissue_weight_mg),
sd = sd(tissue_weight_mg),
normality = shapiro_test(tissue_weight_mg) %>% select(p.value)
cytokines %>%
cytokines %>%
filter(tissue == "ileum") %>%
filter(exp_number == "1") %>%
group_by(group) %>%
summarize(mean = mean(tissue_weight_mg),
media = median(tissue_weight_mg),
sd = sd(tissue_weight_mg),
normality = shapiro_test(tissue_weight_mg) %>% select(normality$p.value))
tbl_tissue_exp1 <- cytokines %>%
filter(tissue == "ileum") %>%
filter(exp_number == "1") %>%
group_by(group) %>%
summarize(mean = mean(tissue_weight_mg),
media = median(tissue_weight_mg),
sd = sd(tissue_weight_mg),
normality = shapiro_test(tissue_weight_mg))
tbl_tissue_exp1
View(tbl_tissue_exp1)
View(tbl_tissue_exp1)
cytokines %>%
filter(tissue == "ileum") %>%
filter(exp_number == "1") %>%
group_by(group) %>%
summarize(mean = mean(tissue_weight_mg),
media = median(tissue_weight_mg),
sd = sd(tissue_weight_mg),
normality = shapiro_test(tissue_weight_mg))
cytokines %>%
filter(tissue == "ileum") %>%
filter(exp_number == "1") %>%
ggplot(aes(x = group, y = tissue_weight_mg, fill = group)) +
geom_boxplot() +
geom_point()
cytokines %>%
filter(tissue == "ileum") %>%
filter(exp_number == "1") %>%
group_by(group) %>%
summarize(mean = mean(tissue_weight_mg),
media = median(tissue_weight_mg),
sd = sd(tissue_weight_mg),
normality = shapiro_test(tissue_weight_mg))
tb1 <- cytokines %>%
filter(tissue == "ileum") %>%
filter(exp_number == "1") %>%
group_by(group) %>%
summarize(mean = mean(tissue_weight_mg),
media = median(tissue_weight_mg),
sd = sd(tissue_weight_mg),
normality = shapiro_test(tissue_weight_mg))
tb1
kable(tb1)
as_tibble(tb1)
tb1 <- as_tibble(tb1)
kable(tb1)
print.table(tb1)
tb1 %>%
select(normality)
shapiro_tb1 <- tb1 %>%
select(normality)
kable(shapiro_tb1)
tb1 %>%
select(normality$p.value)
tb1
cytokines %>%
filter(tissue == "ileum") %>%
filter(exp_number == "1") %>%
group_by(group) %>%
shapiro_test(tissue_weight_mg)
tissue_weight_destribution <- cytokines %>%   # run normality test on tissue weight
filter(tissue == "ileum") %>%
filter(exp_number == "1") %>%
group_by(group) %>%
shapiro_test(tissue_weight_mg)
tissue_weight_destribution
#look at tissue weight destribution
cytokines %>%
filter(tissue == "ileum") %>%
filter(exp_number == "1") %>%
ggplot(aes(x = group, y = tissue_weight_mg, fill = group)) +
geom_boxplot() +
geom_point()
tissue_weight_destribution
#normality_check
shapiro_failed <- cytokines_long %>%
filter(exp_number == 1) %>%
filter(tissue == "ileum") %>%
filter(variables != "INFg") %>%
drop_na(values) %>%
group_by(variables, group) %>%
shapiro_test(values) %>%
filter(p < 0.05)
#____Pivot longer____
cytokines_long <- cytokines_adjusted %>%
pivot_longer(.,
cols = INFg:TNFa ,
names_to = "variables",
values_to = "values_adjusted"
)
cytokines_adjusted <- cytokines %>%
pivot_longer(.,
cols = INFg:TNFa ,
names_to = "variables",
values_to = "values"
) %>%
mutate(
group = recode_factor(  #Change the order of the groups to desired plot order
group,
"CON-BF"= "CON-BF",
"CON-FF" = "CON-FF",
"AB-BF"= "AB-BF",
"AB-FF"= "AB-FF"
)) %>%
mutate(values = if_else(tissue == "ileum", values/tissue_weight_mg, values)) %>% #Adjust for tissue weight
pivot_wider(
id_cols = c(
sample_id,exp_number, group, received_antibiotics,maternal_treatment, tissue,tissue_weight_mg),
names_from = variables,
values_from = values_adjusted)
# Import dataset
cytokines <- read_excel("data/processed/cytokines.xlsx")
cytokines_adjusted <- cytokines %>%
pivot_longer(.,
cols = INFg:TNFa ,
names_to = "variables",
values_to = "values"
) %>%
mutate(
group = recode_factor(  #Change the order of the groups to desired plot order
group,
"CON-BF"= "CON-BF",
"CON-FF" = "CON-FF",
"AB-BF"= "AB-BF",
"AB-FF"= "AB-FF"
)) %>%
mutate(values = if_else(tissue == "ileum", values/tissue_weight_mg, values)) %>% #Adjust for tissue weight
pivot_wider(
id_cols = c(
sample_id,exp_number, group, received_antibiotics,maternal_treatment, tissue,tissue_weight_mg),
names_from = variables,
values_from = values_adjusted)
#____Pivot longer____
cytokines_long <- cytokines_adjusted %>%
pivot_longer(.,
cols = INFg:TNFa ,
names_to = "variables",
values_to = "values"
)
cytokines_adjusted <- cytokines %>%
pivot_longer(.,
cols = INFg:TNFa ,
names_to = "variables",
values_to = "values"
) %>%
mutate(
group = recode_factor(  #Change the order of the groups to desired plot order
group,
"CON-BF"= "CON-BF",
"CON-FF" = "CON-FF",
"AB-BF"= "AB-BF",
"AB-FF"= "AB-FF"
)) %>%
mutate(values = if_else(tissue == "ileum", values/tissue_weight_mg, values)) %>% #Adjust for tissue weight
pivot_wider(
id_cols = c(
sample_id,exp_number, group, received_antibiotics,maternal_treatment, tissue,tissue_weight_mg),
names_from = variables,
values_from = values)
#____Pivot longer____
cytokines_long <- cytokines_adjusted %>%
pivot_longer(.,
cols = INFg:TNFa ,
names_to = "variables",
values_to = "values"
)
#normality_check
shapiro_failed <- cytokines_long %>%
filter(exp_number == 1) %>%
filter(tissue == "ileum") %>%
filter(variables != "INFg") %>%
drop_na(values) %>%
group_by(variables, group) %>%
shapiro_test(values) %>%
filter(p < 0.05)
shapiro_failed
cytokines_long %>%
filter(exp_number == 1) %>%
filter(tissue == "ileum") %>%
filter(variables != "INFg") %>%
drop_na(adjusted_values) %>%
ggplot(aes(x = adjusted_values, fill = group)) +
geom_density() +
facet_wrap(~ variables,
scales = "free")
#Density plots. Works
histogram <- cytokines_long %>%
filter(exp_number == 1) %>%
filter(tissue == "ileum") %>%
filter(variables != "INFg") %>%
drop_na(values) %>%
ggplot(aes(x = values, fill = group)) +
geom_density() +
facet_wrap(~ variables,
scales = "free")
histogram
#Jitter plots. Works
jitter_plot <- cytokines_long %>%
filter(exp_number == 1) %>%
filter(tissue == "ileum") %>%
#filter(variables != "INFg") %>%
drop_na(values) %>%
ggplot(aes(x = group, y = values, color = group)) +
geom_jitter() +
facet_wrap(~ variables,
scales = "free")
jitter_plot
#set tissue type
sample_tissue <- "ileum"
tbl1 <- cytokines %>%
filter(exp_number == "1") %>%
filter(tissue == sample_tissue) %>%
select(group,INFg:TNFa) %>%
tbl_summary(by = group,
digits = everything() ~ c(2,1,1),
missing = "no",
include = !"INFg",
# statistic = list(all_continuous() ~ "{mean} ({sd})")  #Un-comment this line to get mean+sd.
#%>%
statistic = list(all_continuous() ~ "{mean} ({sd})")) %>%
add_p() %>%
#modify_footnote("Exp. 1") %>%
modify_header(
label ~ "Cytokines") %>%
modify_spanning_header((c("stat_1", "stat_2", "stat_3", "stat_4") ~ "Treatment groups (N total = {N})"))
tbl1
