#mutate(Log10_values = log10(values)) %>%
select(group, values) %>%
tbl_summary(by = group,
digits = everything() ~ c(2,1,1),
missing = "no",
#type = list(values ~ 'continuous2', Log10_values ~ 'continuous2'),
statistic = list(values ~ "{median} ({p25}, {p75})",
label = list(values ~ "µg/mL"))) %>%
add_p(list(values ~ "kruskal.test", Log10_values ~ "aov")) %>%
# modify_table_styling(
#   columns = label,
#   rows = label == "µg/mL",
#   footnote = "Non-parametric distribution"
# ) %>%
modify_header(
label = "FITC Conc.",
stat_1 = "**VANCO-BF** \n
(n = {n})",
stat_2 = "**VANCO-FVF** \n
(n = {n})",
stat_3 = "**VANCO-SM** \n
(n = {n})") %>%
modify_spanning_header((c("stat_1", "stat_2", "stat_3") ~ "Treatment groups (N total = {N})")) %>%
bold_labels()
tbl1 <- fitc %>%
filter(exp_number == 4) %>%
#mutate(Log10_values = log10(values)) %>%
select(group, values) %>%
tbl_summary(by = group,
digits = everything() ~ c(2,1,1),
missing = "no",
#type = list(values ~ 'continuous2', Log10_values ~ 'continuous2'),
statistic = list(values ~ "{median} ({p25}, {p75})"),
label = values ~ "µg/mL") %>%
add_p() %>%
# modify_table_styling(
#   columns = label,
#   rows = label == "µg/mL",
#   footnote = "Non-parametric distribution"
# ) %>%
modify_header(
label = "FITC Conc.",
stat_1 = "**VANCO-BF** \n
(n = {n})",
stat_2 = "**VANCO-FVF** \n
(n = {n})",
stat_3 = "**VANCO-SM** \n
(n = {n})") %>%
modify_spanning_header((c("stat_1", "stat_2", "stat_3") ~ "Treatment groups (N total = {N})")) %>%
bold_labels()
tbl1_gt <- tbl1 %>%
as_gt(include = -tab_footnote) %>%
tab_footnote(
footnote = md("Median (IQR), Kruskal-Wallis."),
locations = cells_column_labels(columns = c(p.value))
) %>%
tab_header(title = md("**Intestinal permeability**")) %>%
opt_align_table_header("center") %>%
tab_options(heading.title.font.size = 20,
heading.background.color = "lightgrey"
) %>%
# tab_source_note(
#   source_note = " µg/mL values"
# ) %>%
tab_source_note(
source_note = md("**Matrinem round 4**")
) %>%
cols_width(label ~ px(100),
stat_1 ~ px(150),
stat_2 ~ px(150),
stat_3 ~ px(150))
tbl1_gt
# Import dataset
#cytokines <- read_excel("../../Data/RawData/cytokines_round_1_r.xlsm")
cytokines <- read_excel("data/processed/cytokines.xlsx")
#set tissue type
sample_tissue <- "ileum"
study_round <- "4"
cytokines %>%   # run normality test on tissue weight
filter(exp_number == 4) %>%
filter(tissue == sample_tissue) %>%
group_by(type_of_feed) %>%
shapiro_test(tissue_weight_mg)
cytokines %>%       #Weight of tissue samples
filter(exp_number == study_round) %>%
filter(tissue == sample_tissue) %>%
ggplot(aes(x = group, y = tissue_weight_mg, fill = group)) +
geom_boxplot() +
geom_point() +
labs(
title = "Weight of intestinal samples",
x = "",
y = "Tissue weight (mg)",
fill = "Groups",
caption = "Matrinem round 3") +
theme_bw()
cytokines %>%       #Weight of tissue samples
filter(exp_number == study_round) %>%
filter(tissue == sample_tissue) %>%
ggplot(aes(x = group, y = tissue_weight_mg, fill = group)) +
geom_boxplot() +
geom_point() +
labs(
title = "Weight of intestinal samples",
x = "",
y = "Tissue weight (mg)",
fill = "Groups",
caption = "Matrinem round 4") +
theme_bw()
tbl1 <- cytokines %>%
filter(exp_number == study_round) %>%
filter(tissue == sample_tissue) %>%
select(group,INFg:TNFa) %>%
tbl_summary(by = group,
digits = everything() ~ c(2,1,1),
missing = "no") %>%
add_p() %>%
modify_header(
label ~ "Cytokines",
stat_1 = "**VANCO-BF** \n
(n = {n})",
stat_2 = "**VANCO-FVF** \n
(n = {n})",
stat_3 = "**VANCO-SM** \n
(n = {n})") %>%
modify_spanning_header((c("stat_1", "stat_2", "stat_3") ~ "Treatment groups (N total = {N})"))
tbl1_gt <- tbl1 %>%
as_gt() %>%
tab_header(title = md("**Proinflammatory cytokines (pg/mL)**")) %>%
opt_align_table_header("center") %>%
tab_options(heading.title.font.size = 20,
heading.background.color = "lightgrey",
) %>%
tab_source_note(
source_note = " * P-value indicates overall group differences"
) %>%
tab_source_note(
source_note = md("**Matrinem round 4**")
) %>%
cols_width(label ~ px(100),
stat_1 ~ px(150),
stat_2 ~ px(150),
stat_3 ~ px(150))
tbl1_gt
tbl1_gt <- tbl1 %>%
as_gt() %>%
tab_header(title = md("**Proinflammatory cytokines (pg/mL)**")) %>%
opt_align_table_header("center") %>%
tab_options(heading.title.font.size = 20,
heading.background.color = "lightgrey",
) %>%
tab_source_note(
source_note = md("**Matrinem round 4**")
) %>%
cols_width(label ~ px(100),
stat_1 ~ px(150),
stat_2 ~ px(150),
stat_3 ~ px(150))
tbl1_gt
tbl1 <- cytokines %>%
filter(exp_number == study_round) %>%
filter(tissue == sample_tissue) %>%
select(group,INFg:TNFa) %>%
tbl_summary(by = group,
digits = everything() ~ c(2,1,1),
missing = "no") %>%
add_p() %>%
modify_header(
label ~ "Cytokines",
stat_1 = "**VANCO-BF** \n(n = {n})",
stat_2 = "**VANCO-FVF** \n(n = {n})",
stat_3 = "**VANCO-SM** \n(n = {n})") %>%
modify_spanning_header((c("stat_1", "stat_2", "stat_3") ~ "Treatment groups (N total = {N})"))
tbl1_gt <- tbl1 %>%
as_gt() %>%
tab_header(title = md("**Proinflammatory cytokines (pg/mL)**")) %>%
opt_align_table_header("center") %>%
tab_options(heading.title.font.size = 20,
heading.background.color = "lightgrey",
) %>%
tab_source_note(
source_note = md("**Matrinem round 4**")
) %>%
cols_width(label ~ px(100),
stat_1 ~ px(150),
stat_2 ~ px(150),
stat_3 ~ px(150))
tbl1_gt <- tbl1 %>%
as_gt() %>%
tab_header(title = md("**Tissue conentration of proinflammatory cytokines** *(pg/mL)*")) %>%
opt_align_table_header("center") %>%
tab_options(heading.title.font.size = 20,
heading.background.color = "lightgrey",
) %>%
tab_source_note(
source_note = md("**Matrinem round 4**")
) %>%
cols_width(label ~ px(100),
stat_1 ~ px(150),
stat_2 ~ px(150),
stat_3 ~ px(150))
tbl1_gt
library(readxl)
library(tidyverse)
library(gt)
library(gtsummary)
library(broom)
library(rstatix)
library(knitr)
library(patchwork)
library(ggpubr)
# Import dataset
#cytokines <- read_excel("../../Data/RawData/cytokines_round_1_r.xlsm")
cytokines <- read_excel("data/processed/cytokines.xlsx")
#set tissue type
sample_tissue <- "ileum"
study_round <- "4"
cytokines %>%   # run normality test on tissue weight
filter(exp_number == 4) %>%
filter(tissue == sample_tissue) %>%
group_by(type_of_feed) %>%
shapiro_test(tissue_weight_mg)
cytokines %>%       #Weight of tissue samples
filter(exp_number == study_round) %>%
filter(tissue == sample_tissue) %>%
ggplot(aes(x = group, y = tissue_weight_mg, fill = group)) +
geom_boxplot() +
geom_point() +
labs(
title = "Weight of intestinal samples",
x = "",
y = "Tissue weight (mg)",
fill = "Groups",
caption = "Matrinem round 4") +
theme_bw()
cytokines_long <- cytokines %>%
filter(exp_number == study_round) %>%
filter(tissue == sample_tissue) %>%
pivot_longer(.,
cols = INFg:TNFa ,
names_to = "variables",
values_to = "values"
) %>%
drop_na(
values) %>%
# mutate(MAT = ifelse(str_detect(group,'AB'),'AB',
#                                 ifelse(str_detect(group,'CON'),'CON', "miss")),
#        FEED = ifelse(str_detect(group,'FF'),'FF',
#                                 ifelse(str_detect(group,'BF'),'BF', "miss"))) %>%
mutate(
group = recode_factor(#Change the order of the groups to desired plot order
group,
"VANCO-BF"= "VANCO-BF",
"VANCO-FORM+FVT" = "VANCO-FF (FVT)",
"VANCO-FORM+SM" = "VANCO-FF (SM)"
))
plot_all_cytokines <- cytokines_long %>%
mutate(values = values/tissue_weight_mg) %>%
#filter(!variables %in% "INFg") %>%  #Exclude any cytokines not wanted in the plot
ggplot(aes(x = group,
y = values,
fill = group)) +
geom_boxplot() +
facet_wrap(~variables,
scales = 'free',
nrow = 5,
ncol = 2) +
labs(title = "Levels of pro-inflammatory cytokines in the ileum",  # Change title, and axis names
x = "",
y = "Tissue conc.",
fill = "Groups",
caption = "Matrinem round 4") +
theme_bw()+
theme(                   # Change the appearance of labels
plot.title = element_text(color="darkgrey", size=12, face="bold"),
axis.title.y = element_text(color="darkgrey", size=10, face="bold.italic"),
axis.text.y = element_blank(),
axis.ticks.x = element_blank(),  # Hide labels
axis.text.x = element_blank(),
legend.title = element_text(face="bold"),
legend.position="bottom",
legend.background = element_rect(fill="lightgrey"), # Change legend box background color
plot.caption = element_text(color = "darkgrey", size=5)) +
scale_fill_brewer(palette="Set1")
plot_all_cytokines
plot_all_cytokines <- cytokines_long %>%
#mutate(values = values/tissue_weight_mg) %>%    #to run analysis on tissue-weight adjusted concentrations
#filter(!variables %in% "INFg") %>%  #Exclude any cytokines not wanted in the plot
ggplot(aes(x = group,
y = values,
fill = group)) +
geom_boxplot() +
facet_wrap(~variables,
scales = 'free',
nrow = 5,
ncol = 2) +
labs(title = "Levels of pro-inflammatory cytokines in the ileum",  # Change title, and axis names
x = "",
y = "Tissue conc.",
fill = "Groups",
caption = "Matrinem round 4") +
theme_bw()+
theme(                   # Change the appearance of labels
plot.title = element_text(color="darkgrey", size=12, face="bold"),
axis.title.y = element_text(color="darkgrey", size=10, face="bold.italic"),
axis.text.y = element_blank(),
axis.ticks.x = element_blank(),  # Hide labels
axis.text.x = element_blank(),
legend.title = element_text(face="bold"),
legend.position="bottom",
legend.background = element_rect(fill="lightgrey"), # Change legend box background color
plot.caption = element_text(color = "darkgrey", size=5)) +
scale_fill_brewer(palette="Set1")
plot_all_cytokines
knitr::opts_chunk$set(echo = TRUE)
library(readxl)
library(tidyverse)
library(broom)
library(ggpubr)
library(AICcmodavg)
library(visdat)
library(rstatix)
library(gt)
library(gtsummary)
library(patchwork)
delta_gene_expr <- read_excel("data/processed/gene_expression_fold_changes.xlsx")
View(delta_gene_expr)
bar_charts_selected_genes <- delta_gene_expr %>%
filter(genes %in% c("TNFa","IL1b", "REG3G")) %>%
mutate(
groups = recode_factor(  #Change the order of the groups to desired plot order
groups,
"con-bf"= "VANCO-BF",
"fvt-form" = "VANCO-FVF",
"sm-form" = "VANCO-SM"
)) %>%
group_by(genes, groups) %>%
summarise(mean_fold_change = mean(relative_fold_change)) %>%
ggplot(
aes(x = groups,
y = mean_fold_change,
fill = groups)
) +
geom_col() +
facet_wrap(~genes,
ncol = 5,
scales = "free") +
labs(title = "Level of gene expression in ileum tissue - significant changes",
y = "Gene expression relative fold change",
x = "",
fill = "Groups",
caption = "Matrinem round 4") +
theme_bw()+
theme(                   # Change the appearance of labels
plot.title = element_text(color="darkgrey", size=12, face="bold"),
axis.title.y = element_text(color="darkgrey", size=10, face="bold.italic"),
axis.ticks.x = element_blank(),  # Hide labels
axis.text.x = element_blank(),
legend.title = element_text(face="bold"),
legend.position="bottom",
legend.background = element_rect(fill="lightgrey"), # Change legend box background color
plot.caption = element_text(color = "darkgrey", size=5)) +
scale_fill_brewer(palette="Set1")
bar_charts_selected_genes
bar_charts_all_genes <- delta_gene_expr %>%
mutate(
groups = recode_factor(  #Change the order of the groups to desired plot order
groups,
"con-bf"= "CON-BF",
"fvt-form" = "VANCO-FVF",
"sm-form" = "VANCO-FF (SM)"
)) %>%
group_by(genes, groups) %>%
summarise(mean_fold_change = mean(relative_fold_change)) %>%
ggplot(
aes(x = groups,
y = mean_fold_change,
fill = groups)
) +
geom_col() +
facet_wrap(~genes,
ncol = 5,
scales = "free") +
labs(title = "Level of gene expression in ileum tissue",
y = "Gene expression relative fold change",
x = "",
fill = "Groups",
caption = "Matrinem round 4") +
theme_bw()+
theme(                   # Change the appearance of labels
plot.title = element_text(color="darkgrey", size=12, face="bold"),
axis.title.y = element_text(color="darkgrey", size=10, face="bold.italic"),
axis.ticks.x = element_blank(),  # Hide labels
axis.text.x = element_blank(),
legend.title = element_text(face="bold"),
legend.position="bottom",
legend.background = element_rect(fill="lightgrey"), # Change legend box background color
plot.caption = element_text(color = "darkgrey", size=5)) +
scale_fill_brewer(palette="Set1")
bar_charts_all_genes
bar_charts_all_genes
bar_charts_selected_genes <- delta_gene_expr %>%
filter(genes %in% c("TNFa","IL1b", "REG3G")) %>%
mutate(
groups = recode_factor(  #Change the order of the groups to desired plot order
groups,
"con-bf"= "VANCO-BF",
"fvt-form" = "VANCO-FVF",
"sm-form" = "VANCO-SM"
)) %>%
group_by(genes, groups) %>%
summarise(mean_fold_change = mean(relative_fold_change)) %>%
ggplot(
aes(x = groups,
y = mean_fold_change,
fill = groups)
) +
geom_col() +
facet_wrap(~genes,
ncol = 5,
scales = "free") +
labs(title = "Level of gene expression in ileum tissue - significant changes",
y = "Gene expression relative fold change",
x = "",
fill = "Groups",
caption = "Matrinem round 4") +
theme_bw()+
theme(                   # Change the appearance of labels
plot.title = element_text(color="darkgrey", size=12, face="bold"),
axis.title.y = element_text(color="darkgrey", size=10, face="bold.italic"),
axis.ticks.x = element_blank(),  # Hide labels
axis.text.x = element_blank(),
legend.title = element_text(face="bold"),
legend.position="bottom",
legend.background = element_rect(fill="lightgrey"), # Change legend box background color
plot.caption = element_text(color = "darkgrey", size=5)) +
scale_fill_brewer(palette="Set1")
bar_charts_selected_genes
bar_charts_selected_genes
bar_charts_all_genes <- delta_gene_expr %>%
mutate(
groups = recode_factor(  #Change the order of the groups to desired plot order
groups,
"con-bf"= "CON-BF",
"fvt-form" = "VANCO-FVF",
"sm-form" = "VANCO-FF (SM)"
)) %>%
group_by(genes, groups) %>%
summarise(mean_fold_change = mean(relative_fold_change)) %>%
ggplot(
aes(x = groups,
y = mean_fold_change,
fill = groups)
) +
geom_col() +
facet_wrap(~genes,
ncol = 5,
scales = "free") +
labs(title = "Level of gene expression in ileum tissue",
y = "Gene expression relative fold change",
x = "",
fill = "Groups",
caption = "Matrinem round 4") +
theme_bw()+
theme(                   # Change the appearance of labels
plot.title = element_text(color="darkgrey", size=12, face="bold"),
axis.title.y = element_text(color="darkgrey", size=10, face="bold.italic"),
axis.ticks.x = element_blank(),  # Hide labels
axis.text.x = element_blank(),
legend.title = element_text(face="bold"),
legend.position="bottom",
legend.background = element_rect(fill="lightgrey"), # Change legend box background color
plot.caption = element_text(color = "darkgrey", size=5)) +
scale_fill_brewer(palette="Set1")
bar_charts_all_genes
bar_charts_selected_genes <- delta_gene_expr %>%
filter(genes %in% c("TNFa","IL1b", "REG3G")) %>%
mutate(
groups = recode_factor(  #Change the order of the groups to desired plot order
groups,
"con-bf"= "VANCO-BF",
"fvt-form" = "VANCO-FVF",
"sm-form" = "VANCO-SM"
)) %>%
group_by(genes, groups) %>%
summarise(mean_fold_change = mean(relative_fold_change)) %>%
ggplot(
aes(x = groups,
y = mean_fold_change,
fill = groups)
) +
geom_col() +
facet_wrap(~genes,
ncol = 5,
scales = "free") +
labs(title = "Level of gene expression in ileum tissue - significant changes",
y = "Gene expression relative fold change",
x = "",
fill = "Groups",
caption = "Matrinem round 4") +
theme_bw()+
theme(                   # Change the appearance of labels
plot.title = element_text(color="darkgrey", size=12, face="bold"),
axis.title.y = element_text(color="darkgrey", size=10, face="bold.italic"),
axis.ticks.x = element_blank(),  # Hide labels
axis.text.x = element_blank(),
legend.title = element_text(face="bold"),
legend.position="bottom",
legend.background = element_rect(fill="lightgrey"), # Change legend box background color
plot.caption = element_text(color = "darkgrey", size=5)) +
scale_fill_brewer(palette="Set1")
bar_charts_selected_genes
