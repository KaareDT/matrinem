signif_cytokines
signif_cytokines <- cytokines_long %>%
filter(variables %in% c("IL-2","IL-6", "KCGRO")) %>%
filter(values > 0.5) %>% #Exclude any cytokines not wanted in the plot
ggplot(aes(x = group,
y = values,
fill = group)) +
geom_boxplot() +
facet_wrap(~variables,
scales = 'free') +
stat_compare_means(comparisons = my_comparisons, label.y.npc =  c(0.20, 0.20, 0.20), method = "wilcox.test") +
labs(title = "Levels of pro-inflammatory cytokines in the ileum", # Change title, and axis names
#subtitle = "Statistically significant changes",
x = "",
y = "Cytokine concentration (pg/ml)",
fill = "Groups") +
theme_bw()+
theme(                   # Change the appearance of labels
plot.title = element_text(color="darkgrey", size=12, face="bold"),
axis.title.y = element_text(color="darkgrey", size=10, face="bold.italic"),
#axis.text.y = element_blank(),
axis.ticks.x = element_blank(),  # Hide labels
axis.text.x = element_blank(),
legend.title = element_text(face="bold"),
legend.position="bottom",
legend.background = element_rect(fill="white")) + # Change legend box background color
scale_fill_brewer(palette="Set1")
signif_cytokines
signif_cytokines <- cytokines_long %>%
filter(variables %in% c("IL-2","IL-6", "KCGRO")) %>%
filter(values > 0.5) %>% #Exclude any cytokines not wanted in the plot
ggplot(aes(x = group,
y = values,
fill = group)) +
geom_boxplot() +
facet_wrap(~variables,
scales = 'free') +
stat_compare_means(comparisons = my_comparisons, label.y.npc =  c(0.20, 0.15, 0.1), method = "wilcox.test") +
labs(title = "Levels of pro-inflammatory cytokines in the ileum", # Change title, and axis names
#subtitle = "Statistically significant changes",
x = "",
y = "Cytokine concentration (pg/ml)",
fill = "Groups") +
theme_bw()+
theme(                   # Change the appearance of labels
plot.title = element_text(color="darkgrey", size=12, face="bold"),
axis.title.y = element_text(color="darkgrey", size=10, face="bold.italic"),
#axis.text.y = element_blank(),
axis.ticks.x = element_blank(),  # Hide labels
axis.text.x = element_blank(),
legend.title = element_text(face="bold"),
legend.position="bottom",
legend.background = element_rect(fill="white")) + # Change legend box background color
scale_fill_brewer(palette="Set1")
signif_cytokines
signif_cytokines <- cytokines_long %>%
filter(variables %in% c("IL-2","IL-6", "KCGRO")) %>%
filter(values > 0.5) %>% #Exclude any cytokines not wanted in the plot
ggplot(aes(x = group,
y = values,
fill = group)) +
geom_boxplot() +
facet_wrap(~variables,
scales = 'free') +
stat_compare_means(comparisons = my_comparisons, method = "wilcox.test") +
labs(title = "Levels of pro-inflammatory cytokines in the ileum", # Change title, and axis names
#subtitle = "Statistically significant changes",
x = "",
y = "Cytokine concentration (pg/ml)",
fill = "Groups") +
theme_bw()+
theme(                   # Change the appearance of labels
plot.title = element_text(color="darkgrey", size=12, face="bold"),
axis.title.y = element_text(color="darkgrey", size=10, face="bold.italic"),
#axis.text.y = element_blank(),
axis.ticks.x = element_blank(),  # Hide labels
axis.text.x = element_blank(),
legend.title = element_text(face="bold"),
legend.position="bottom",
legend.background = element_rect(fill="white")) + # Change legend box background color
scale_fill_brewer(palette="Set1")
signif_cytokines
signif_cytokines <- cytokines_long %>%
filter(variables %in% c("IL-2","IL-6", "KCGRO")) %>%
filter(values > 0.5) %>% #Exclude any cytokines not wanted in the plot
ggplot(aes(x = group,
y = values,
fill = group)) +
geom_boxplot() +
facet_wrap(~variables,
scales = 'free') +
stat_compare_means(comparisons = my_comparisons, label.y.npc =  c(0.20, 0.15, 0.1), method = "wilcox.test") +
labs(title = "Levels of pro-inflammatory cytokines in the ileum", # Change title, and axis names
#subtitle = "Statistically significant changes",
x = "",
y = "Cytokine concentration (pg/ml)",
fill = "Groups") +
theme_bw()+
theme(                   # Change the appearance of labels
plot.title = element_text(color="darkgrey", size=12, face="bold"),
axis.title.y = element_text(color="darkgrey", size=10, face="bold.italic"),
#axis.text.y = element_blank(),
axis.ticks.x = element_blank(),  # Hide labels
axis.text.x = element_blank(),
legend.title = element_text(face="bold"),
legend.position="bottom",
legend.background = element_rect(fill="white")) + # Change legend box background color
scale_fill_brewer(palette="Set1")
signif_cytokines_patch <- signif_cytokines + plot_annotation (
#title = 'Cytokine expression',
#subtitle = 'Statistically significant changes',
#tag_levels = 'A',
caption = 'CON = Water, AB = Antibiotics, BF = Breast-Feeding, FF = Formula-Feeding. \n
Pairwise comparisons using wilcoxon test.',
theme = theme(plot.title = element_text(hjust = 0.5, size=14, face="bold"),
plot.subtitle = element_text(hjust = 0.5, face = "bold.italic"),
plot.caption = element_text(hjust = 0.5, size=7,face = "bold")))
signif_cytokines_patch
#tbl1_p contains cytokines with significant changes
my_comparisons <- list( c("CON-BF", "CON-FF"), c("GENTA-BF", "GENTA-FF"), c("GENTA-FF", "VANCO-FF"))
signif_cytokines <- cytokines_long %>%
filter(variables %in% c("IL-2","IL-6", "KCGRO")) %>%
filter(values > 0.5) %>% #Exclude any cytokines not wanted in the plot
ggplot(aes(x = group,
y = values,
fill = group)) +
geom_boxplot() +
facet_wrap(~variables,
scales = 'free') +
stat_compare_means(comparisons = my_comparisons, label.y.npc =  c(0.20, 0.15, 0.1), method = "wilcox.test") +
labs(title = "Levels of pro-inflammatory cytokines in the ileum", # Change title, and axis names
#subtitle = "Statistically significant changes",
x = "",
y = "Cytokine concentration (pg/ml)",
fill = "Groups") +
theme_bw()+
theme(                   # Change the appearance of labels
plot.title = element_text(color="darkgrey", size=12, face="bold"),
axis.title.y = element_text(color="darkgrey", size=10, face="bold.italic"),
#axis.text.y = element_blank(),
axis.ticks.x = element_blank(),  # Hide labels
axis.text.x = element_blank(),
legend.title = element_text(face="bold"),
legend.position="bottom",
legend.background = element_rect(fill="white")) + # Change legend box background color
scale_fill_brewer(palette="Set1")
signif_cytokines_patch <- signif_cytokines + plot_annotation (
#title = 'Cytokine expression',
#subtitle = 'Statistically significant changes',
#tag_levels = 'A',
caption = 'CON = Water, AB = Antibiotics, BF = Breast-Feeding, FF = Formula-Feeding. \n
Pairwise comparisons using wilcoxon test.',
theme = theme(plot.title = element_text(hjust = 0.5, size=14, face="bold"),
plot.subtitle = element_text(hjust = 0.5, face = "bold.italic"),
plot.caption = element_text(hjust = 0.5, size=7,face = "bold")))
signif_cytokines_patch
#tbl1_p contains cytokines with significant changes
my_comparisons <- list( c("CON-BF", "CON-FF"), c("GENTA-BF", "GENTA-FF"))
signif_cytokines <- cytokines_long %>%
filter(variables %in% c("IL-2","IL-6", "KCGRO")) %>%
filter(values > 0.5) %>% #Exclude any cytokines not wanted in the plot
ggplot(aes(x = group,
y = values,
fill = group)) +
geom_boxplot() +
facet_wrap(~variables,
scales = 'free') +
stat_compare_means(comparisons = my_comparisons, label.y.npc =  c(0.20, 0.15), method = "wilcox.test") +
labs(title = "Levels of pro-inflammatory cytokines in the ileum", # Change title, and axis names
#subtitle = "Statistically significant changes",
x = "",
y = "Cytokine concentration (pg/ml)",
fill = "Groups") +
theme_bw()+
theme(                   # Change the appearance of labels
plot.title = element_text(color="darkgrey", size=12, face="bold"),
axis.title.y = element_text(color="darkgrey", size=10, face="bold.italic"),
#axis.text.y = element_blank(),
axis.ticks.x = element_blank(),  # Hide labels
axis.text.x = element_blank(),
legend.title = element_text(face="bold"),
legend.position="bottom",
legend.background = element_rect(fill="white")) + # Change legend box background color
scale_fill_brewer(palette="Set1")
signif_cytokines_patch <- signif_cytokines + plot_annotation (
#title = 'Cytokine expression',
#subtitle = 'Statistically significant changes',
#tag_levels = 'A',
caption = 'CON = Water, AB = Antibiotics, BF = Breast-Feeding, FF = Formula-Feeding. \n
Pairwise comparisons using wilcoxon test.',
theme = theme(plot.title = element_text(hjust = 0.5, size=14, face="bold"),
plot.subtitle = element_text(hjust = 0.5, face = "bold.italic"),
plot.caption = element_text(hjust = 0.5, size=7,face = "bold")))
signif_cytokines_patch
signif_cytokines <- cytokines_long %>%
filter(variables %in% c("IL-2","IL-6", "KCGRO")) %>%
filter(values > 0.5) %>% #Exclude any cytokines not wanted in the plot
ggplot(aes(x = group,
y = values,
fill = group)) +
geom_boxplot() +
stat_compare_means(comparisons = my_comparisons, label.y.npc =  c(0.20, 0.15), method = "wilcox.test") +
facet_wrap(~variables,
scales = 'free') +
labs(title = "Levels of pro-inflammatory cytokines in the ileum", # Change title, and axis names
#subtitle = "Statistically significant changes",
x = "",
y = "Cytokine concentration (pg/ml)",
fill = "Groups") +
theme_bw()+
theme(                   # Change the appearance of labels
plot.title = element_text(color="darkgrey", size=12, face="bold"),
axis.title.y = element_text(color="darkgrey", size=10, face="bold.italic"),
#axis.text.y = element_blank(),
axis.ticks.x = element_blank(),  # Hide labels
axis.text.x = element_blank(),
legend.title = element_text(face="bold"),
legend.position="bottom",
legend.background = element_rect(fill="white")) + # Change legend box background color
scale_fill_brewer(palette="Set1")
signif_cytokines_patch <- signif_cytokines + plot_annotation (
#title = 'Cytokine expression',
#subtitle = 'Statistically significant changes',
#tag_levels = 'A',
caption = 'CON = Water, AB = Antibiotics, BF = Breast-Feeding, FF = Formula-Feeding. \n
Pairwise comparisons using wilcoxon test.',
theme = theme(plot.title = element_text(hjust = 0.5, size=14, face="bold"),
plot.subtitle = element_text(hjust = 0.5, face = "bold.italic"),
plot.caption = element_text(hjust = 0.5, size=7,face = "bold")))
signif_cytokines_patch
# Import dataset
cytokines <- read_excel("data/processed/cytokines.xlsx")
#set tissue type
sample_tissue <- "ileum"
study_round <- "3"
cytokines %>%   # run normality test on tissue weight
filter(exp_number == study_round) %>%
filter(tissue == sample_tissue) %>%
group_by(group) %>%
shapiro_test(tissue_weight_mg)
cytokines %>%       #Weight of tissue samples
filter(exp_number == study_round) %>%
filter(tissue == sample_tissue) %>%
ggplot(aes(x = group, y = tissue_weight_mg, fill = group)) +
geom_boxplot() +
geom_point() +
labs(
title = "Tissue weight of intestinal samples, experiment 2"
)
cytokines_adjusted <- cytokines %>%
pivot_longer(.,
cols = INFg:TNFa ,
names_to = "variables",
values_to = "values"
) %>%
mutate(
group = recode_factor(  #Change the order of the groups to desired plot order
group,
"CON-BF"= "CON-BF",
"CON-FF" = "CON-FF",
"AB-BF"= "AB-BF",
"AB-FF"= "AB-FF"
)) %>%
mutate(values = if_else(tissue == "ileum", values/tissue_weight_mg, values)) %>% #Adjust for tissue weight
pivot_wider(
id_cols = c(
sample_id,exp_number, group, received_antibiotics,maternal_treatment, tissue,tissue_weight_mg),
names_from = variables,
values_from = values)
#____Pivot longer____
cytokines_long <- cytokines_adjusted %>%
pivot_longer(.,
cols = INFg:TNFa ,
names_to = "variables",
values_to = "values"
)
cytokines_long %>%                       #normality_check  of cytokine distributions
filter(exp_number == study_round) %>%
filter(tissue == sample_tissue) %>%
#filter(variables != "INFg") %>%
drop_na(values) %>%
group_by(variables, group) %>%
shapiro_test(values) %>%
filter(p < 0.05)
tbl1 <- cytokines %>%
filter(exp_number == study_round) %>%
filter(tissue == sample_tissue) %>%
select(group,INFg:TNFa) %>%
tbl_summary(by = group,
digits = everything() ~ c(2,1,1),
missing = "no") %>%
add_p() %>%
modify_header(
label ~ "Cytokines") %>%
modify_spanning_header((c("stat_1", "stat_2", "stat_3") ~ "Treatment groups (N total = {N})"))
tbl1_gt <- tbl1 %>%
as_gt() %>%
tab_header(title = md("**Proinflammatory cytokines**")) %>%
opt_align_table_header("center") %>%
tab_options(heading.title.font.size = 20,
heading.background.color = "lightgrey",
) %>%
tab_source_note(
source_note = " * P-value indicates overall group differences"
) %>%
tab_source_note(
source_note = md("**Matrinem round 2**")
) %>%
cols_width(label ~ px(100),
stat_1 ~ px(150),
stat_2 ~ px(150),
stat_3 ~ px(150))
tbl1_gt
tbl1_p <- tbl1 %>%
filter_p() %>%
as_tibble()
plot_all_cytokines <- cytokines_long %>%
filter(exp_number == study_round) %>%
filter(tissue == sample_tissue) %>%
#filter(!variables %in% "INFg") %>%  #Exclude any cytokines not wanted in the plot
ggplot(aes(x = group,
y = values,
fill = group)) +
geom_boxplot() +
facet_wrap(~variables,
scales = 'free',
nrow = 5,
ncol = 2) +
labs(title = "Levels of pro-inflammatory cytokines in the ileum",  # Change title, and axis names
x = "",
y = "pg/ml per mg tissue",
fill = "Groups",
caption = "Matrinem round 2") +
theme_bw()+
theme(                   # Change the appearance of labels
plot.title = element_text(color="darkgrey", size=12, face="bold"),
axis.title.y = element_text(color="darkgrey", size=10, face="bold.italic"),
#axis.text.y = element_blank(),
axis.ticks.x = element_blank(),  # Hide labels
axis.text.x = element_blank(),
legend.title = element_text(face="bold"),
legend.position="bottom",
legend.background = element_rect(fill="lightgrey"), # Change legend box background color
plot.caption = element_text(color = "darkgrey", size=5)) +
scale_fill_brewer(palette="Set1")
all_cytokines_patch <- plot_all_cytokines + plot_annotation (
#title = 'Cytokine expression',
#subtitle = 'All cytokines measured',
#tag_levels = 'A',
caption = 'CON = Water, BF = Breast-Feeding, GENTA = Gentamicin,  VANCO = Vancomycin',
theme = theme(plot.title = element_text(hjust = 0.5, size=14, face="bold"),
plot.subtitle = element_text(hjust = 0.5, face = "bold.italic"),
plot.caption = element_text(hjust = 0.5, size=7,face = "bold")))
all_cytokines_patch
signif_cytokines <- cytokines_long %>%
filter(variables %in% tbl1_p$Cytokines) %>%  #Exclude any cytokines not wanted in the plot
ggplot(aes(x = group,
y = values,
fill = group)) +
geom_boxplot() +
stat_compare_means(aes(label = ..p.signif..),
method = "wilcox.test", ref.group = "CON-BF",
label.y.npc = 0.55) +
stat_compare_means(
aes(label = paste0("Kruskal-Wallis \n p = ", ..p.format..)),
label.y.npc = 0.9,
label.x.npc = 0.5) +
facet_wrap(~variables,
scales = 'free',
nrow = 3,
ncol = 3) +
labs(title = "Levels of pro-inflammatory cytokines in the ileum", # Change title, and axis names
#subtitle = "Statistically significant changes",
x = "",
y = "Tissue conc. (pg/mg)",
fill = "Groups",
caption = "Matrinem round 2") +
theme_bw()+
theme(                   # Change the appearance of labels
plot.title = element_text(color="darkgrey", size=12, face="bold"),
axis.title.y = element_text(color="darkgrey", size=10, face="bold.italic"),
axis.text.y = element_blank(),
axis.ticks.x = element_blank(),  # Hide labels
axis.text.x = element_blank(),
legend.title = element_text(face="bold"),
legend.position="bottom",
legend.background = element_rect(fill="white")) + # Change legend box background color
scale_fill_brewer(palette="Set1")
signif_cytokines_patch <- signif_cytokines + plot_annotation (
title = 'Cytokine expression',
subtitle = 'Statistically significant changes',
tag_levels = 'A',
caption = 'CON = Water, AB = Antibiotics, BF = Breast-Feeding, FF = Formula-Feeding. \n
Pairwise comparisons with CON-BF using wilcoxon test',
theme = theme(plot.title = element_text(hjust = 0.5, size=14, face="bold"),
plot.subtitle = element_text(hjust = 0.5, face = "bold.italic"),
plot.caption = element_text(hjust = 0.5, size=7,face = "bold")))
signif_cytokines_patch
signif_cytokines <- cytokines_long %>%
filter(exp_number == study_round) %>%
filter(tissue == sample_tissue) %>%
filter(variables %in% tbl1_p$Cytokines) %>%  #Exclude any cytokines not wanted in the plot
ggplot(aes(x = group,
y = values,
fill = group)) +
geom_boxplot() +
stat_compare_means(aes(label = ..p.signif..),
method = "wilcox.test", ref.group = "CON-BF",
label.y.npc = 0.55) +
stat_compare_means(
aes(label = paste0("Kruskal-Wallis \n p = ", ..p.format..)),
label.y.npc = 0.9,
label.x.npc = 0.5) +
facet_wrap(~variables,
scales = 'free',
nrow = 3,
ncol = 3) +
labs(title = "Levels of pro-inflammatory cytokines in the ileum", # Change title, and axis names
#subtitle = "Statistically significant changes",
x = "",
y = "Tissue conc. (pg/mg)",
fill = "Groups",
caption = "Matrinem round 2") +
theme_bw()+
theme(                   # Change the appearance of labels
plot.title = element_text(color="darkgrey", size=12, face="bold"),
axis.title.y = element_text(color="darkgrey", size=10, face="bold.italic"),
axis.text.y = element_blank(),
axis.ticks.x = element_blank(),  # Hide labels
axis.text.x = element_blank(),
legend.title = element_text(face="bold"),
legend.position="bottom",
legend.background = element_rect(fill="white")) + # Change legend box background color
scale_fill_brewer(palette="Set1")
signif_cytokines_patch <- signif_cytokines + plot_annotation (
title = 'Cytokine expression',
subtitle = 'Statistically significant changes',
tag_levels = 'A',
caption = 'CON = Water, AB = Antibiotics, BF = Breast-Feeding, FF = Formula-Feeding. \n
Pairwise comparisons with CON-BF using wilcoxon test',
theme = theme(plot.title = element_text(hjust = 0.5, size=14, face="bold"),
plot.subtitle = element_text(hjust = 0.5, face = "bold.italic"),
plot.caption = element_text(hjust = 0.5, size=7,face = "bold")))
signif_cytokines_patch
cytokines %>%       #Weight of tissue samples
filter(exp_number == study_round) %>%
filter(tissue == sample_tissue) %>%
ggplot(aes(x = group, y = tissue_weight_mg, fill = group)) +
geom_boxplot() +
geom_point() +
labs(
title = "Tissue weight of intestinal samples, experiment 3"
)
cytokines %>%       #Weight of tissue samples
filter(exp_number == study_round) %>%
filter(tissue == sample_tissue) %>%
ggplot(aes(x = group, y = tissue_weight_mg, fill = group)) +
geom_boxplot() +
geom_point() +
labs(
title = "Tissue weight of intestinal samples, experiment 3",
ylab = "Weight of tissue (mg)",
xlab = ""
)
cytokines %>%       #Weight of tissue samples
filter(exp_number == study_round) %>%
filter(tissue == sample_tissue) %>%
ggplot(aes(x = group, y = tissue_weight_mg, fill = group)) +
geom_boxplot() +
geom_point() +
labs(
title = "Tissue weight of intestinal samples, experiment 3",
ylab = "Weight of tissue (mg)",
xlab = ""
)
cytokines %>%       #Weight of tissue samples
filter(exp_number == study_round) %>%
filter(tissue == sample_tissue) %>%
ggplot(aes(x = group, y = tissue_weight_mg, fill = group)) +
geom_boxplot() +
geom_point() +
labs(
title = "Tissue weight of intestinal samples, experiment 3",
x = "",
y = "Weight of tissue (mg)",
fill = "Groups",
caption = "Matrinem round 3")
cytokines %>%       #Weight of tissue samples
filter(exp_number == study_round) %>%
filter(tissue == sample_tissue) %>%
ggplot(aes(x = group, y = tissue_weight_mg, fill = group)) +
geom_boxplot() +
geom_point() +
labs(
title = "Weight of intestinal samples",
x = "",
y = "Tissue weight (mg)",
fill = "Groups",
caption = "Matrinem round 3")
cytokines %>%       #Weight of tissue samples
filter(exp_number == study_round) %>%
filter(tissue == sample_tissue) %>%
ggplot(aes(x = group, y = tissue_weight_mg, fill = group)) +
geom_boxplot() +
geom_point() +
labs(
title = "Weight of intestinal samples",
x = "",
y = "Tissue weight (mg)",
fill = "Groups",
caption = "Matrinem round 3") +
theme_bw()
