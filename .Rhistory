#stat_compare_means(aes(label = paste0("Kruskal-Wallis \n p = ", ..p.format..)),
# label.y.npc = 0.75,
#label.x.npc = 0.55) +
labs( # Change title, and axis names
x = "",
y = "Serum FITC conc. (µg/ml)",
fill = "Groups",
caption = "Matrinem round 4") +
theme_bw()+
theme(                   # Change the appearance of labels
plot.title = element_text(color="darkgrey", size=12, face="bold"),
axis.title.y = element_text(color="darkgrey", size=10, face="bold.italic"),
#axis.text.y = element_blank(),
axis.ticks.x = element_blank(),  # Hide labels
axis.text.x = element_blank(),
legend.title = element_text(face="bold"),
legend.position="bottom",
legend.background = element_rect(fill="lightgrey"),#Change legend box background color
plot.caption = element_text(color = "darkgrey", size=5)) +
scale_fill_brewer(palette="Set1")
plot_all_fitc
all_fitc_patch <- plot_all_fitc + plot_annotation (
title = 'Intestinal permeability',
#subtitle = 'All fitc measured',
#tag_levels = 'A',
caption = 'VANCO = Vancomycin, BF = Breast-Feeding, FF = Formula-Feeding\n
FVF = Fecal Virome Filtrate, SM = SM-buffer',
theme = theme(plot.title = element_text(hjust = 0.5, size=14, face="bold"),
plot.subtitle = element_text(hjust = 0.5, face = "bold.italic"),
plot.caption = element_text(hjust = 0.5, size=7,face = "bold")))
all_fitc_patch
plot_all_fitc <- fitc_long %>%
ggplot(aes(x = group,
y = values,
fill = group)) +
geom_boxplot() +
geom_point() +
coord_cartesian(ylim = c(10,35)) +
stat_compare_means(comparisons = my_comparisons, label.y = c(20, 25), method = "wilcox.test") +
#stat_compare_means(aes(label = paste0("Kruskal-Wallis \n p = ", ..p.format..)),
# label.y.npc = 0.75,
#label.x.npc = 0.55) +
labs( # Change title, and axis names
x = "",
y = "Serum FITC conc. (µg/ml)",
fill = "Groups"
#caption = "Matrinem round 4"
) +
theme_bw()+
theme(                   # Change the appearance of labels
plot.title = element_text(color="darkgrey", size=12, face="bold"),
axis.title.y = element_text(color="darkgrey", size=10, face="bold.italic"),
#axis.text.y = element_blank(),
axis.ticks.x = element_blank(),  # Hide labels
axis.text.x = element_blank(),
legend.title = element_text(face="bold"),
legend.position="bottom",
legend.background = element_rect(fill="lightgrey"),#Change legend box background color
plot.caption = element_text(color = "darkgrey", size=5)) +
scale_fill_brewer(palette="Set1")
all_fitc_patch <- plot_all_fitc + plot_annotation (
title = 'Intestinal permeability',
#subtitle = 'All fitc measured',
#tag_levels = 'A',
caption = 'FVF = Fecal Virome Filtrate, SM = SM-buffer  \n
Pairwise comparisions using wilcoxon',
theme = theme(plot.title = element_text(hjust = 0.5, size=14, face="bold"),
plot.subtitle = element_text(hjust = 0.5, face = "bold.italic"),
plot.caption = element_text(hjust = 0.5, size=7,face = "bold")))
all_fitc_patch
tbl1 <- fitc %>%
filter(exp_number == 4) %>%
mutate(Log10_values = log10(values)) %>%
select(group, values, Log10_values) %>%
tbl_summary(by = group,
digits = everything() ~ c(2,1,1),
missing = "no",
#type = list(values ~ 'continuous2', Log10_values ~ 'continuous2'),
statistic = list(values ~ "{median} ({p25}, {p75})", Log10_values ~"{mean} ({sd}"),
label = list(values ~ "µg/mL", Log10_values ~ "Log transformed")) %>%
add_p(list(values ~ "kruskal.test", Log10_values ~ "aov")) %>%
# modify_table_styling(
#   columns = label,
#   rows = label == "µg/mL",
#   footnote = "Non-parametric distribution"
# ) %>%
modify_header(
label = "FITC Conc.",
stat_1 = "**VANCO-BF**\n  (n = {n})",
stat_2 = "**VANCO-FVF** \n  (n = {n})",
stat_3 = "**VANCO-SM** \n  (n = {n})") %>%
modify_spanning_header((c("stat_1", "stat_2", "stat_3") ~ "Treatment groups (N total = {N})")) %>%
bold_labels()
tbl1_gt <- tbl1 %>%
as_gt(include = -tab_footnote) %>%
tab_footnote(
footnote = md("Non-transformed results = median (IQR), Kruskal-Wallis.
Logtransformed = mean (SD), One-way Anova."),
locations = cells_column_labels(columns = c(p.value))
) %>%
tab_header(title = md("**Intestinal permeability**")) %>%
opt_align_table_header("center") %>%
tab_options(heading.title.font.size = 20,
heading.background.color = "lightgrey"
) %>%
# tab_source_note(
#   source_note = " µg/mL values"
# ) %>%
tab_source_note(
source_note = md("**Matrinem round 4**")
) %>%
cols_width(label ~ px(100),
stat_1 ~ px(150),
stat_2 ~ px(150),
stat_3 ~ px(150))
tbl1_gt
tbl1 <- fitc %>%
filter(exp_number == 4) %>%
mutate(Log10_values = log10(values)) %>%
select(group, values, Log10_values) %>%
tbl_summary(by = group,
digits = everything() ~ c(2,1,1),
missing = "no",
#type = list(values ~ 'continuous2', Log10_values ~ 'continuous2'),
statistic = list(values ~ "{median} ({p25}, {p75})", Log10_values ~"{mean} ({sd}"),
label = list(values ~ "µg/mL", Log10_values ~ "Log transformed")) %>%
add_p(list(values ~ "kruskal.test", Log10_values ~ "aov")) %>%
# modify_table_styling(
#   columns = label,
#   rows = label == "µg/mL",
#   footnote = "Non-parametric distribution"
# ) %>%
modify_header(
label = "FITC Conc.",
stat_1 = "**VANCO-BF** \n  (n = {n})",
stat_2 = "**VANCO-FVF** \n  (n = {n})",
stat_3 = "**VANCO-SM** \n  (n = {n})") %>%
modify_spanning_header((c("stat_1", "stat_2", "stat_3") ~ "Treatment groups (N total = {N})")) %>%
bold_labels()
tbl1_gt <- tbl1 %>%
as_gt(include = -tab_footnote) %>%
tab_footnote(
footnote = md("Non-transformed results = median (IQR), Kruskal-Wallis.
Logtransformed = mean (SD), One-way Anova."),
locations = cells_column_labels(columns = c(p.value))
) %>%
tab_header(title = md("**Intestinal permeability**")) %>%
opt_align_table_header("center") %>%
tab_options(heading.title.font.size = 20,
heading.background.color = "lightgrey"
) %>%
# tab_source_note(
#   source_note = " µg/mL values"
# ) %>%
tab_source_note(
source_note = md("**Matrinem round 4**")
) %>%
cols_width(label ~ px(100),
stat_1 ~ px(150),
stat_2 ~ px(150),
stat_3 ~ px(150))
tbl1_gt
tbl1 <- fitc %>%
filter(exp_number == 4) %>%
mutate(Log10_values = log10(values)) %>%
select(group, values, Log10_values) %>%
tbl_summary(by = group,
digits = everything() ~ c(2,1,1),
missing = "no",
#type = list(values ~ 'continuous2', Log10_values ~ 'continuous2'),
statistic = list(values ~ "{median} ({p25}, {p75})", Log10_values ~"{mean} ({sd}"),
label = list(values ~ "µg/mL", Log10_values ~ "Log transformed")) %>%
add_p(list(values ~ "kruskal.test", Log10_values ~ "aov")) %>%
# modify_table_styling(
#   columns = label,
#   rows = label == "µg/mL",
#   footnote = "Non-parametric distribution"
# ) %>%
modify_header(
label = "FITC Conc.",
stat_1 = "**VANCO-BF** \n
(n = {n})",
stat_2 = "**VANCO-FVF** \n
(n = {n})",
stat_3 = "**VANCO-SM** \n
(n = {n})") %>%
modify_spanning_header((c("stat_1", "stat_2", "stat_3") ~ "Treatment groups (N total = {N})")) %>%
bold_labels()
tbl1_gt <- tbl1 %>%
as_gt(include = -tab_footnote) %>%
tab_footnote(
footnote = md("Non-transformed results = median (IQR), Kruskal-Wallis.
Logtransformed = mean (SD), One-way Anova."),
locations = cells_column_labels(columns = c(p.value))
) %>%
tab_header(title = md("**Intestinal permeability**")) %>%
opt_align_table_header("center") %>%
tab_options(heading.title.font.size = 20,
heading.background.color = "lightgrey"
) %>%
# tab_source_note(
#   source_note = " µg/mL values"
# ) %>%
tab_source_note(
source_note = md("**Matrinem round 4**")
) %>%
cols_width(label ~ px(100),
stat_1 ~ px(150),
stat_2 ~ px(150),
stat_3 ~ px(150))
tbl1_gt
tbl1 <- fitc %>%
filter(exp_number == 4) %>%
mutate(Log10_values = log10(values)) %>%
select(group, values, Log10_values) %>%
tbl_summary(by = group,
digits = everything() ~ c(2,1,1),
missing = "no",
#type = list(values ~ 'continuous2', Log10_values ~ 'continuous2'),
statistic = list(values ~ "{median} ({p25}, {p75})", Log10_values ~"{mean} ({sd}"),
label = list(values ~ "µg/mL", Log10_values ~ "Log transformed")) %>%
add_p(list(values ~ "kruskal.test", Log10_values ~ "aov")) %>%
# modify_table_styling(
#   columns = label,
#   rows = label == "µg/mL",
#   footnote = "Non-parametric distribution"
# ) %>%
modify_header(
label = "FITC Conc.",
stat_1 = "**VANCO-BF** \n
(n = {n})",
stat_2 = "**VANCO-FVF** \n
(n = {n})",
stat_3 = "**VANCO-SM** \n
(n = {n})") %>%
modify_spanning_header((c("stat_1", "stat_2", "stat_3") ~ "Treatment groups (N total = {N})")) %>%
bold_labels()
tbl1_gt <- tbl1 %>%
as_gt(include = -tab_footnote) %>%
tab_footnote(
footnote = md("Non-transformed results = median (IQR), Kruskal-Wallis.
Logtransformed = mean (SD), One-way Anova."),
locations = cells_column_labels(columns = c(p.value))
) %>%
tab_header(title = md("**Intestinal permeability**")) %>%
opt_align_table_header("center") %>%
tab_options(heading.title.font.size = 20,
heading.background.color = "lightgrey"
) %>%
# tab_source_note(
#   source_note = " µg/mL values"
# ) %>%
tab_source_note(
source_note = md("**Matrinem round 4**")
) %>%
cols_width(label ~ px(100),
stat_1 ~ px(150),
stat_2 ~ px(150),
stat_3 ~ px(150))
tbl1_gt
tbl1 <- fitc %>%
filter(exp_number == 4) %>%
#mutate(Log10_values = log10(values)) %>%
select(group, values) %>%
tbl_summary(by = group,
digits = everything() ~ c(2,1,1),
missing = "no",
#type = list(values ~ 'continuous2', Log10_values ~ 'continuous2'),
statistic = list(values ~ "{median} ({p25}, {p75})",
label = list(values ~ "µg/mL"))) %>%
add_p(list(values ~ "kruskal.test", Log10_values ~ "aov")) %>%
# modify_table_styling(
#   columns = label,
#   rows = label == "µg/mL",
#   footnote = "Non-parametric distribution"
# ) %>%
modify_header(
label = "FITC Conc.",
stat_1 = "**VANCO-BF** \n
(n = {n})",
stat_2 = "**VANCO-FVF** \n
(n = {n})",
stat_3 = "**VANCO-SM** \n
(n = {n})") %>%
modify_spanning_header((c("stat_1", "stat_2", "stat_3") ~ "Treatment groups (N total = {N})")) %>%
bold_labels()
tbl1_gt <- tbl1 %>%
as_gt(include = -tab_footnote) %>%
tab_footnote(
footnote = md("Median (IQR), Kruskal-Wallis."),
locations = cells_column_labels(columns = c(p.value))
) %>%
tab_header(title = md("**Intestinal permeability**")) %>%
opt_align_table_header("center") %>%
tab_options(heading.title.font.size = 20,
heading.background.color = "lightgrey"
) %>%
# tab_source_note(
#   source_note = " µg/mL values"
# ) %>%
tab_source_note(
source_note = md("**Matrinem round 4**")
) %>%
cols_width(label ~ px(100),
stat_1 ~ px(150),
stat_2 ~ px(150),
stat_3 ~ px(150))
tbl1_gt
tbl1 <- fitc %>%
filter(exp_number == 4) %>%
#mutate(Log10_values = log10(values)) %>%
select(group, values) %>%
tbl_summary(by = group,
digits = everything() ~ c(2,1,1),
missing = "no",
#type = list(values ~ 'continuous2', Log10_values ~ 'continuous2'),
statistic = list(values ~ "{median} ({p25}, {p75})",
label = list(values ~ "µg/mL"))) %>%
add_p(list(values ~ "kruskal.test", Log10_values ~ "aov")) %>%
# modify_table_styling(
#   columns = label,
#   rows = label == "µg/mL",
#   footnote = "Non-parametric distribution"
# ) %>%
modify_header(
label = "FITC Conc.",
stat_1 = "**VANCO-BF** \n
(n = {n})",
stat_2 = "**VANCO-FVF** \n
(n = {n})",
stat_3 = "**VANCO-SM** \n
(n = {n})") %>%
modify_spanning_header((c("stat_1", "stat_2", "stat_3") ~ "Treatment groups (N total = {N})")) %>%
bold_labels()
tbl1 <- fitc %>%
filter(exp_number == 4) %>%
#mutate(Log10_values = log10(values)) %>%
select(group, values) %>%
tbl_summary(by = group,
digits = everything() ~ c(2,1,1),
missing = "no",
#type = list(values ~ 'continuous2', Log10_values ~ 'continuous2'),
statistic = list(values ~ "{median} ({p25}, {p75})"),
label = values ~ "µg/mL") %>%
add_p() %>%
# modify_table_styling(
#   columns = label,
#   rows = label == "µg/mL",
#   footnote = "Non-parametric distribution"
# ) %>%
modify_header(
label = "FITC Conc.",
stat_1 = "**VANCO-BF** \n
(n = {n})",
stat_2 = "**VANCO-FVF** \n
(n = {n})",
stat_3 = "**VANCO-SM** \n
(n = {n})") %>%
modify_spanning_header((c("stat_1", "stat_2", "stat_3") ~ "Treatment groups (N total = {N})")) %>%
bold_labels()
tbl1_gt <- tbl1 %>%
as_gt(include = -tab_footnote) %>%
tab_footnote(
footnote = md("Median (IQR), Kruskal-Wallis."),
locations = cells_column_labels(columns = c(p.value))
) %>%
tab_header(title = md("**Intestinal permeability**")) %>%
opt_align_table_header("center") %>%
tab_options(heading.title.font.size = 20,
heading.background.color = "lightgrey"
) %>%
# tab_source_note(
#   source_note = " µg/mL values"
# ) %>%
tab_source_note(
source_note = md("**Matrinem round 4**")
) %>%
cols_width(label ~ px(100),
stat_1 ~ px(150),
stat_2 ~ px(150),
stat_3 ~ px(150))
tbl1_gt
# Import dataset
#cytokines <- read_excel("../../Data/RawData/cytokines_round_1_r.xlsm")
cytokines <- read_excel("data/processed/cytokines.xlsx")
#set tissue type
sample_tissue <- "ileum"
study_round <- "4"
cytokines %>%   # run normality test on tissue weight
filter(exp_number == 4) %>%
filter(tissue == sample_tissue) %>%
group_by(type_of_feed) %>%
shapiro_test(tissue_weight_mg)
cytokines %>%       #Weight of tissue samples
filter(exp_number == study_round) %>%
filter(tissue == sample_tissue) %>%
ggplot(aes(x = group, y = tissue_weight_mg, fill = group)) +
geom_boxplot() +
geom_point() +
labs(
title = "Weight of intestinal samples",
x = "",
y = "Tissue weight (mg)",
fill = "Groups",
caption = "Matrinem round 3") +
theme_bw()
cytokines %>%       #Weight of tissue samples
filter(exp_number == study_round) %>%
filter(tissue == sample_tissue) %>%
ggplot(aes(x = group, y = tissue_weight_mg, fill = group)) +
geom_boxplot() +
geom_point() +
labs(
title = "Weight of intestinal samples",
x = "",
y = "Tissue weight (mg)",
fill = "Groups",
caption = "Matrinem round 4") +
theme_bw()
tbl1 <- cytokines %>%
filter(exp_number == study_round) %>%
filter(tissue == sample_tissue) %>%
select(group,INFg:TNFa) %>%
tbl_summary(by = group,
digits = everything() ~ c(2,1,1),
missing = "no") %>%
add_p() %>%
modify_header(
label ~ "Cytokines",
stat_1 = "**VANCO-BF** \n
(n = {n})",
stat_2 = "**VANCO-FVF** \n
(n = {n})",
stat_3 = "**VANCO-SM** \n
(n = {n})") %>%
modify_spanning_header((c("stat_1", "stat_2", "stat_3") ~ "Treatment groups (N total = {N})"))
tbl1_gt <- tbl1 %>%
as_gt() %>%
tab_header(title = md("**Proinflammatory cytokines (pg/mL)**")) %>%
opt_align_table_header("center") %>%
tab_options(heading.title.font.size = 20,
heading.background.color = "lightgrey",
) %>%
tab_source_note(
source_note = " * P-value indicates overall group differences"
) %>%
tab_source_note(
source_note = md("**Matrinem round 4**")
) %>%
cols_width(label ~ px(100),
stat_1 ~ px(150),
stat_2 ~ px(150),
stat_3 ~ px(150))
tbl1_gt
tbl1_gt <- tbl1 %>%
as_gt() %>%
tab_header(title = md("**Proinflammatory cytokines (pg/mL)**")) %>%
opt_align_table_header("center") %>%
tab_options(heading.title.font.size = 20,
heading.background.color = "lightgrey",
) %>%
tab_source_note(
source_note = md("**Matrinem round 4**")
) %>%
cols_width(label ~ px(100),
stat_1 ~ px(150),
stat_2 ~ px(150),
stat_3 ~ px(150))
tbl1_gt
tbl1 <- cytokines %>%
filter(exp_number == study_round) %>%
filter(tissue == sample_tissue) %>%
select(group,INFg:TNFa) %>%
tbl_summary(by = group,
digits = everything() ~ c(2,1,1),
missing = "no") %>%
add_p() %>%
modify_header(
label ~ "Cytokines",
stat_1 = "**VANCO-BF** \n(n = {n})",
stat_2 = "**VANCO-FVF** \n(n = {n})",
stat_3 = "**VANCO-SM** \n(n = {n})") %>%
modify_spanning_header((c("stat_1", "stat_2", "stat_3") ~ "Treatment groups (N total = {N})"))
tbl1_gt <- tbl1 %>%
as_gt() %>%
tab_header(title = md("**Proinflammatory cytokines (pg/mL)**")) %>%
opt_align_table_header("center") %>%
tab_options(heading.title.font.size = 20,
heading.background.color = "lightgrey",
) %>%
tab_source_note(
source_note = md("**Matrinem round 4**")
) %>%
cols_width(label ~ px(100),
stat_1 ~ px(150),
stat_2 ~ px(150),
stat_3 ~ px(150))
tbl1_gt <- tbl1 %>%
as_gt() %>%
tab_header(title = md("**Tissue conentration of proinflammatory cytokines** *(pg/mL)*")) %>%
opt_align_table_header("center") %>%
tab_options(heading.title.font.size = 20,
heading.background.color = "lightgrey",
) %>%
tab_source_note(
source_note = md("**Matrinem round 4**")
) %>%
cols_width(label ~ px(100),
stat_1 ~ px(150),
stat_2 ~ px(150),
stat_3 ~ px(150))
tbl1_gt
