library(readxl)
library(tidyverse)
library(broom)
library(ggpubr)
#library(AICcmodavg)
library(visdat)
library(rstatix)
library(gt)
library(gtsummary)
library(patchwork)
library(jtools)
library(readxl)
library(tidyverse)
library(broom)
library(ggpubr)
#library(AICcmodavg)
library(visdat)
library(rstatix)
library(gt)
library(gtsummary)
library(patchwork)
library(jtools)
preexp_1 <- read_excel("../data/processed/weight_development.xlsx") %>%
filter(exp_number == "1")
getwd()
list
preexp_1 <- read_excel("data/processed/weight_development.xlsx") %>%
filter(exp_number == "1")
#__________Load in cytokine data for all experiments________
cytokines_1 <- read_excel(path = "../data/processed/cytokines.xlsx") %>%
filter(exp_number == 1) %>%
filter(tissue == "ileum") %>%
mutate(
group = recode_factor(  #Change the order of the groups to desired plot order
group,
"CON-BF"= "CON-BF",
"CON-FF" = "CON-FF",
"AB-BF"= "AB-BF",
"AB-FF"= "AB-FF"
))
#__________Load in cytokine data for all experiments________
cytokines_1 <- read_excel(path = "data/processed/cytokines.xlsx") %>%
filter(exp_number == 1) %>%
filter(tissue == "ileum") %>%
mutate(
group = recode_factor(  #Change the order of the groups to desired plot order
group,
"CON-BF"= "CON-BF",
"CON-FF" = "CON-FF",
"AB-BF"= "AB-BF",
"AB-FF"= "AB-FF"
))
#__________ Pivot longer  ____________
cytokines_1_long <- cytokines_1 %>%
pivot_longer(cols = INFg:TNFa,
names_to = "cytokines",
values_to = "cytokine_concentration") %>%
drop_na(cytokine_concentration)
#___________ Check cytokine distribution for normality, filter significant ones _____________________
normality_check <- cytokines_1_long %>%
group_by(cytokines) %>%
shapiro_test(cytokine_concentration) %>%
select(cytokines, p)
non_normal_cytokines <- normality_check %>%
filter(p < 0.05)
#___________ Jitterplot of all non-normally distributed cytokines _____________________
normality_plot <- cytokines_1_long %>%
filter(cytokines %in% non_normal_cytokines$cytokines ) %>%
ggplot(aes(x = group,
y = cytokine_concentration,
color = group)) +
geom_jitter() +
facet_wrap(~ cytokines,
scales = "free") +
labs(title = "Non-normally distributed cytokines (Shapiro-Wilk Normality Test, p < 0.05)",
y = "Concentration of cytokine in tissue (pg/mL)",
x = "") +
theme_bw()
#___________ Jitterplot of all non-normally distributed cytokines _____________________
normality_result_1 <- normality_check %>%
knitr::kable(caption = "Normallity check of cytokine distribution (Shapiro-Wilk Normality Test, p < 0.05)")
names_of_cytokines <-unique(cytokines_1_long$cytokines)
names_of_cytokines <-unique(cytokines_1_long$cytokines)
knitr::opts_chunk$set(echo = FALSE)
nrow(preexp_1)
nrow(preexp_1)
nrow(cytokines_1)
`r nrow(cytokines_1)` samples were available for analysis of concentrations of the proinflammatory cytokines `r names_of_cytokines`. Concentrations were measured in 1-cm sections of proximal/distal ileum tissue using MSD Mesoscale Kits. Distributions were assessed for normality with Shapiro-Wilk Normality Test (see table below), and plot of data were made to assess distributions visually:
`r nrow(cytokines_1)` samples were available for analysis of concentrations of the proinflammatory cytokines `r names_of_cytokines`. Concentrations were measured in 1-cm sections of proximal/distal ileum tissue using MSD Mesoscale Kits. Distributions were assessed for normality with Shapiro-Wilk Normality Test (see table below), and plot of data were made to assess distributions visually:
names_of_cytokines <-unique(cytokines_1_long$cytokines)
names_of_cytokines
names_of_cytokines <-unique(cytokines_1_long$cytokines)
nrow(preexp_1)
nrow(cytokines_1)
names_of_cytokines
normality_result_1
normality_plot
tbl1 <- cytokines_1 %>%
select(group,INFg:TNFa) %>%
tbl_summary(by = group,
digits = everything() ~ c(2,1,1),
missing = "no",
include = !"INFg") %>%
add_p() %>%
modify_header(
label ~ "Cytokines") %>%
modify_spanning_header((c("stat_1", "stat_2", "stat_3", "stat_4") ~ "Total number of mice analyzed = {N}"))
tbl1_gt <- tbl1 %>%
as_gt() %>%
tab_header(title = md("**Proinflammatory cytokines**")) %>%
opt_align_table_header("center") %>%
tab_options(heading.title.font.size = 20,
heading.background.color = "lightgrey",
) %>%
tab_source_note(
source_note = " * P-value indicates overall group differences"
) %>%
tab_source_note(
source_note = md("**Matrinem round 1**")
) %>%
cols_width(label ~ px(100),
stat_1 ~ px(150),
stat_2 ~ px(150),
stat_3 ~ px(150),
stat_4 ~ px(150))
tbl1_gt
signif_cytokines_patch
normality_plot
#___________ Jitterplot of all non-normally distributed cytokines _____________________
normality_plot <- cytokines_1_long %>%
#filter(cytokines %in% non_normal_cytokines$cytokines ) %>%
ggplot(aes(x = group,
y = cytokine_concentration,
color = group)) +
geom_jitter() +
facet_wrap(~ cytokines,
scales = "free") +
labs(title = "Non-normally distributed cytokines (Shapiro-Wilk Normality Test, p < 0.05)",
y = "Concentration of cytokine in tissue (pg/mL)",
x = "") +
theme_bw()
normality_plot
#___________ Jitterplot of all non-normally distributed cytokines _____________________
normality_plot <- cytokines_1_long %>%
#filter(cytokines %in% non_normal_cytokines$cytokines ) %>%
ggplot(aes(x = group,
y = cytokine_concentration,
color = group)) +
geom_boxplot(outlier.shape = NA) +
geom_jitter() +
facet_wrap(~ cytokines,
scales = "free") +
labs(title = "Non-normally distributed cytokines (Shapiro-Wilk Normality Test, p < 0.05)",
y = "Concentration of cytokine in tissue (pg/mL)",
x = "") +
theme_bw()
normality_plot
cytokines_1
View(cytokines_1)
#__________ Pivot longer  ____________
cytokines_1_long <- cytokines_1 %>%
pivot_longer(cols = INFg:TNFa,
names_to = "cytokines",
values_to = "cytokine_concentration") %>%
drop_na(cytokine_concentration)
cytokines_1_long
#____ adjust for weight of tissue____
cytokines_1_long_adj <- cytokines_1_log %>%
mutate(adjusted = cytokines_1_long$cytokine_concentration/cytokines_1_long$tissue_weight_mg)
#____ adjust for weight of tissue____
cytokines_1_long_adj <- cytokines_1_long %>%
mutate(adjusted = cytokines_1_long$cytokine_concentration/cytokines_1_long$tissue_weight_mg)
View(cytokines_1_long_adj)
#__________ Pivot longer  ____________
cytokines_1_long <- cytokines_1 %>%
pivot_longer(cols = INFg:TNFa,
names_to = "cytokines",
values_to = "cytokine_concentration") %>%
drop_na(cytokine_concentration) %>%
mutate(conc_adjusted4weight = cytokine_concentration/tissue_weight_mg)
#___________ Check cytokine distribution for normality, filter significant ones _____________________
normality_check <- cytokines_1_long %>%
group_by(cytokines) %>%
shapiro_test(conc_adjusted4weight) %>%
select(cytokines, p)
normality_check
non_normal_cytokines <- normality_check %>%
filter(p < 0.05)
#___________ Jitterplot of all non-normally distributed cytokines _____________________
normality_plot <- cytokines_1_long %>%
#filter(cytokines %in% non_normal_cytokines$cytokines ) %>%
ggplot(aes(x = group,
y = cytokine_concentration,
color = group)) +
geom_boxplot(outlier.shape = NA) +
geom_jitter() +
facet_wrap(~ cytokines,
scales = "free") +
labs(title = "Non-normally distributed cytokines (Shapiro-Wilk Normality Test, p < 0.05)",
y = "Concentration of cytokine in tissue (pg/mL)",
x = "") +
theme_bw()
normality_plot
#___________ Jitterplot of all non-normally distributed cytokines _____________________
normality_plot <- cytokines_1_long %>%
#filter(cytokines %in% non_normal_cytokines$cytokines ) %>%
ggplot(aes(x = group,
y = conc_adjusted4weight,
color = group)) +
geom_boxplot(outlier.shape = NA) +
geom_jitter() +
facet_wrap(~ cytokines,
scales = "free") +
labs(title = "Non-normally distributed cytokines (Shapiro-Wilk Normality Test, p < 0.05)",
y = "Concentration of cytokine in tissue (pg/mL)",
x = "") +
theme_bw()
normality_plot
#___________ Check cytokine distribution for normality, filter significant ones _____________________
normality_check <- cytokines_1_long %>%
group_by(cytokines) %>%
shapiro_test(conc_adjusted4weight) %>%
select(cytokines, p)
non_normal_cytokines <- normality_check %>%
filter(p < 0.05)
#___________ Jitterplot of all non-normally distributed cytokines _____________________
normality_plot <- cytokines_1_long %>%
filter(cytokines %in% non_normal_cytokines$cytokines ) %>%
ggplot(aes(x = group,
y = conc_adjusted4weight,
color = group)) +
geom_boxplot(outlier.shape = NA) +
geom_jitter() +
facet_wrap(~ cytokines,
scales = "free") +
labs(title = "Non-normally distributed cytokines (Shapiro-Wilk Normality Test, p < 0.05)",
y = "Concentration of cytokine in tissue (pg/mL)",
x = "") +
theme_bw()
normality_plot
#___________ Jitterplot of all non-normally distributed cytokines _____________________
normality_plot <- cytokines_1_long %>%
filter(cytokines %in% non_normal_cytokines$cytokines ) %>%
ggplot(aes(x = group,
y = conc_adjusted4weight,
color = group)) +
geom_boxplot(outlier.shape = NA) +
geom_jitter() +
scale_y_continuous(trans='log10') +
facet_wrap(~ cytokines,
scales = "free") +
labs(title = "Non-normally distributed cytokines (Shapiro-Wilk Normality Test, p < 0.05)",
y = "Concentration of cytokine in tissue (pg/mL)",
x = "") +
theme_bw()
normality_plot
#___________ Jitterplot of all non-normally distributed cytokines _____________________
normality_plot <- cytokines_1_long %>%
filter(cytokines %in% non_normal_cytokines$cytokines ) %>%
ggplot(aes(x = group,
y = log10(conc_adjusted4weight),
color = group)) +
geom_boxplot(outlier.shape = NA) +
geom_jitter() +
#scale_y_continuous(trans='log10') +
facet_wrap(~ cytokines,
scales = "free") +
labs(title = "Non-normally distributed cytokines (Shapiro-Wilk Normality Test, p < 0.05)",
y = "Concentration of cytokine in tissue (pg/mL)",
x = "") +
theme_bw()
normality_plot
View(cytokines_1_long)
cytokines_1 %>%
pivot_longer(cols = INFg:TNFa,
names_to = "cytokines",
values_to = "cytokine_concentration") %>%
drop_na(cytokine_concentration)
cytokines_1
View(cytokines_1)
cytokines_1 %>%
pivot_longer(cols = INFg:TNFa,
names_to = "cytokines",
values_to = "cytokine_concentration") %>%
filter(!cytokine_concentration == 0)
#__________ Pivot longer  ____________
cytokines_1_long <- cytokines_1 %>%
pivot_longer(cols = INFg:TNFa,
names_to = "cytokines",
values_to = "cytokine_concentration") %>%
filter(!cytokine_concentration == 0) %>%
mutate(conc_adjusted4weight = cytokine_concentration/tissue_weight_mg)
#___________ Check cytokine distribution for normality, filter significant ones _____________________
normality_check <- cytokines_1_long %>%
group_by(cytokines) %>%
shapiro_test(conc_adjusted4weight) %>%
select(cytokines, p)
normality_check
View(normality_check)
non_normal_cytokines <- normality_check %>%
filter(p < 0.05)
non_normal_cytokines
#___________ Jitterplot of all non-normally distributed cytokines _____________________
normality_plot <- cytokines_1_long %>%
filter(cytokines %in% non_normal_cytokines$cytokines ) %>%
ggplot(aes(x = group,
y = log10(conc_adjusted4weight),
color = group)) +
geom_boxplot(outlier.shape = NA) +
geom_jitter() +
#scale_y_continuous(trans='log10') +
facet_wrap(~ cytokines,
scales = "free") +
labs(title = "Non-normally distributed cytokines (Shapiro-Wilk Normality Test, p < 0.05)",
y = "Concentration of cytokine in tissue (pg/mL)",
x = "") +
theme_bw()
normality_plot
#___________ Jitterplot of all non-normally distributed cytokines _____________________
normality_plot <- cytokines_1_long %>%
filter(cytokines %in% non_normal_cytokines$cytokines ) %>%
ggplot(aes(x = group,
y = log10(conc_adjusted4weight),
color = group)) +
geom_boxplot(outlier.shape = NA) +
geom_jitter() +
#scale_y_continuous(trans='log10') +
facet_wrap(~ cytokines,
scales = "free") +
labs(title = "Non-normally distributed cytokines (Shapiro-Wilk Normality Test, p < 0.05)",
y = "Log10 scale - Conc. of cytokine (pg/mL) per mg tissue",
x = "") +
theme_bw()
normality_plot
normality_result_1
#___________ Jitterplot of all non-normally distributed cytokines _____________________
normality_result_1 <- normality_check %>%
knitr::kable(caption = "Normallity check of cytokine distribution (Shapiro-Wilk Normality Test, p < 0.05)")
normality_result_1
names_of_cytokines <-unique(cytokines_1_long$cytokines)
names_of_cytokines
normality_result_1
plot_all_cytokines <- cytokines_1_long %>%
#filter(!variables %in% "INFg") %>%  #Exclude any cytokines not wanted in the plot
ggplot(aes(x = group,
y = conc_adjusted4weight,
fill = group)) +
geom_boxplot() +
facet_wrap(~cytokines,
scales = 'free',
nrow = 3,
ncol = 4) +
labs(title = "Levels of pro-inflammatory cytokines in the ileum",  # Change title, and axis names
x = "",
y = "Tissue conc. (pg/mL)",
fill = "Groups") +
theme_bw() +
theme(                   # Change the appearance of labels
plot.title = element_text(color="darkgrey", size=12, face="bold"),
axis.title.y = element_text(color="darkgrey", size=10, face="bold.italic"),
axis.text.y = element_blank(),
axis.ticks.x = element_blank(),  # Hide labels
axis.text.x = element_blank(),
legend.title = element_text(face="bold"),
legend.position="bottom",
legend.background = element_rect(fill="white")) + # Change legend box background color
scale_fill_brewer(palette="Set1")
all_cytokines_patch <- plot_all_cytokines + plot_annotation (
title = 'Cytokine expression',
subtitle = 'All cytokines measured',
tag_levels = 'A',
caption = 'CON = Water, AB = Antibiotics, BF = Breast-Feeding, FF = Formula-Feeding',
theme = theme(plot.title = element_text(hjust = 0.5, size=14, face="bold"),
plot.subtitle = element_text(hjust = 0.5, face = "bold.italic"),
plot.caption = element_text(hjust = 0.5, size=7,face = "bold")))
all_cytokines_patch
library(readxl)
library(tidyverse)
library(broom)
library(ggpubr)
#library(AICcmodavg)
library(visdat)
library(rstatix)
library(gt)
library(gtsummary)
library(patchwork)
library(jtools)
#__________Load in cytokine data for all experiments________
cytokines_1 <- read_excel(path = "data/processed/cytokines.xlsx") %>%
filter(exp_number == 1) %>%
filter(tissue == "ileum") %>%
mutate(
group = recode_factor(  #Change the order of the groups to desired plot order
group,
"CON-BF"= "CON-BF",
"CON-FF" = "CON-FF",
"AB-BF"= "AB-BF",
"AB-FF"= "AB-FF"
))
#__________Load in cytokine data for all experiments________
cytokines <- read_excel(path = "data/processed/cytokines.xlsx")
weight <- read_excel("data/processed/weight_development.xlsx")
cytokines <- read_excel(path = "data/processed/cytokines.xlsx")
fitc <- read_excel("data/processed/fitc.xlsx")
weight %>%
filter(exp_number == "1")
View(weight)
getwd
getwd()
library(tinytex)
install_tinytex("tinytex")
install.packages("tinytex")
install.packages("tinytex")
library(tinytex)
setwd("~/Github/dissertation_template_with_rmd-main")
library(knitr)  # for dynamic report generation
library(kableExtra) # to build complex HTML or 'LaTex' tables
library(kableExtra) # to build complex HTML or 'LaTex' tables
library(tidyverse) # for data manipulation
library(kableExtra) # to build complex HTML or 'LaTex' tables
library(tidyverse) # for data manipulation
puffins_t <- read.csv("./data/puffins_temp.csv")
puffins_t <- puffins_t %>%
rename("Year" = year, "Country list" = Country.list,
"Population trend" = pop_trend, "ID" = id,
"Mean max. T (°C)" = mean_tmax, "Mean min. T (°C)" = mean_tmin)
puffins_t %>%
slice(1:10) %>%   # the table is going to show only the first 10 lines (a sample of the data set)
kable(digits = 2) %>% # each value has 2 decimal digits
kable_styling(full_width = F, # the width of the table is not fit to the width of the page
position = "center", font_size = 10,
latex_options = "hold_position")  # table settings with the kableExtra package
include_graphics("img/meant_plot.png")
