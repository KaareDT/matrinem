filter(tissue == "ileum") %>%
filter(variables != "INFg") %>%
drop_na(adjusted_values) %>%
mutate(adjusted_values = log10(adjusted_values)) %>%
group_by(variables, group) %>%
shapiro_test(adjusted_values) %>%
filter(p < 0.05)
log10_shapiro_failed <- cytokines_long %>%
filter(exp_number == 1) %>%
filter(tissue == "ileum") %>%
filter(variables != "INFg") %>%
drop_na(values) %>%
mutate(values = log10(values)) %>%
group_by(variables, group) %>%
shapiro_test(values) %>%
filter(p < 0.05)
log10_shapiro_failed
log10_shapiro_failed
tbl1 <- cytokines %>%
filter(exp_number == 1) %>%
filter(tissue == "ileum") %>%
#filter(variables != "INFg") %>%
select(group, INFg:TNFa) %>%
tbl_summary(by = group,
digits = everything() ~ c(2,1,1),
missing = "no",
include = !INFg,
statistic = list(all_continuous() ~ "{mean} ({sd})" )
) %>%
add_p() %>%
modify_header(
label ~ "**Groups**")
tbl1
tbl1 <- cytokines %>%
filter(exp_number == 1) %>%
filter(tissue == "ileum") %>%
#filter(variables != "INFg") %>%
select(group, INFg:TNFa) %>%
tbl_summary(by = group,
digits = everything() ~ c(1,1,1),
missing = "no",
include = !INFg,
statistic = list(all_continuous() ~ "{mean} ({sd})" )
) %>%
add_p() %>%
modify_header(
label ~ "**Groups**")
tbl1
tbl1 <- cytokines %>%
filter(exp_number == "1") %>%
filter(tissue == "ileum") %>%
select(group,INFg:TNFa) %>%
tbl_summary(by = group,
digits = everything() ~ c(2,1,1),
missing = "no",
include = !"INFg",
# statistic = list(all_continuous() ~ "{mean} ({sd})")  #Un-comment this line to get mean+sd.
%>%
tbl1 <- cytokines %>%
filter(exp_number == "1") %>%
filter(tissue == "ileum") %>%
select(group,INFg:TNFa) %>%
tbl_summary(by = group,
digits = everything() ~ c(2,1,1),
missing = "no",
include = !"INFg",
# statistic = list(all_continuous() ~ "{mean} ({sd})")  #Un-comment this line to get mean+sd.
#%>%
statistic = list(all_continuous() ~ "{mean} ({sd})")) %>%
add_p() %>%
modify_header(
label ~ "Cytokines") %>%
modify_spanning_header((c("stat_1", "stat_2", "stat_3", "stat_4") ~ "Treatment groups (N total = {N})"))
tbl1_gt <- tbl1 %>%
as_gt() %>%
tab_header(title = md("**Proinflammatory cytokines**")) %>%
opt_align_table_header("center") %>%
tab_options(heading.title.font.size = 20,
heading.background.color = "lightgrey",
) %>%
tab_source_note(
source_note = " * P-value indicates overall group differences"
) %>%
tab_source_note(
source_note = md("**Matrinem round 1**")
) %>%
cols_width(label ~ px(100),
stat_1 ~ px(150),
stat_2 ~ px(150),
stat_3 ~ px(150),
stat_4 ~ px(150))
tbl1_gt
# Save and export files
# tbl1 %>%  #Save as excel file.
#   as_hux_table() %>%
#   huxtable::quick_xlsx(., file = "../Results/Round 1/ileum-cytokines.xlsx")
#
tbl1_gt %>% #Save as image file.
as_flex_table() %>%
flextable::save_as_image(path = "../../Results/Round 1/ileum_cytokines_table.png",webshot = "webshot")
tbl1 <- cytokines %>%
filter(exp_number == "1") %>%
filter(tissue == "ileum") %>%
select(group,INFg:TNFa) %>%
tbl_summary(by = group,
digits = everything() ~ c(2,1,1),
missing = "no",
include = !"INFg",
# statistic = list(all_continuous() ~ "{mean} ({sd})")  #Un-comment this line to get mean+sd.
#%>%
statistic = list(all_continuous() ~ "{mean} ({sd})")) %>%
add_p("aov") %>%
modify_header(
label ~ "Cytokines") %>%
modify_spanning_header((c("stat_1", "stat_2", "stat_3", "stat_4") ~ "Treatment groups (N total = {N})"))
tbl1 <- cytokines %>%
filter(exp_number == "1") %>%
filter(tissue == "ileum") %>%
select(group,INFg:TNFa) %>%
tbl_summary(by = group,
digits = everything() ~ c(2,1,1),
missing = "no",
include = !"INFg",
# statistic = list(all_continuous() ~ "{mean} ({sd})")  #Un-comment this line to get mean+sd.
#%>%
statistic = list(all_continuous() ~ "{mean} ({sd})")) %>%
add_p(`everything() ~ "aov"`) %>%
modify_header(
label ~ "Cytokines") %>%
modify_spanning_header((c("stat_1", "stat_2", "stat_3", "stat_4") ~ "Treatment groups (N total = {N})"))
tbl1 <- cytokines %>%
filter(exp_number == "1") %>%
filter(tissue == "ileum") %>%
select(group,INFg:TNFa) %>%
tbl_summary(by = group,
digits = everything() ~ c(2,1,1),
missing = "no",
include = !"INFg",
# statistic = list(all_continuous() ~ "{mean} ({sd})")  #Un-comment this line to get mean+sd.
#%>%
statistic = list(all_continuous() ~ "{mean} ({sd})")) %>%
add_p(everything() ~ "aov") %>%
modify_header(
label ~ "Cytokines") %>%
modify_spanning_header((c("stat_1", "stat_2", "stat_3", "stat_4") ~ "Treatment groups (N total = {N})"))
tbl1
tbl1 <- cytokines %>%
filter(exp_number == "1") %>%
filter(tissue == "ileum") %>%
select(group,INFg:TNFa) %>%
tbl_summary(by = group,
digits = everything() ~ c(2,1,1),
missing = "no",
include = !"INFg",
# statistic = list(all_continuous() ~ "{mean} ({sd})")  #Un-comment this line to get mean+sd.
#%>%
statistic = list(all_continuous() ~ "{mean} ({sd})")) %>%
add_p() %>%
modify_header(
label ~ "Cytokines") %>%
modify_spanning_header((c("stat_1", "stat_2", "stat_3", "stat_4") ~ "Treatment groups (N total = {N})"))
tbl1 <- cytokines %>%
filter(exp_number == "1") %>%
filter(tissue == "ileum") %>%
select(group,INFg:TNFa) %>%
tbl_summary(by = group,
digits = everything() ~ c(2,1,1),
missing = "no",
include = !"INFg",
# statistic = list(all_continuous() ~ "{mean} ({sd})")  #Un-comment this line to get mean+sd.
#%>%
statistic = list(all_continuous() ~ "{mean} ({sd})")) %>%
add_p() %>%
modify_header(
label ~ "Cytokines") %>%
modify_spanning_header((c("stat_1", "stat_2", "stat_3", "stat_4") ~ "Treatment groups (N total = {N})")) %>%
modify_caption( "Exp 1")
tbl1
tbl1 <- cytokines %>%
filter(exp_number == "1") %>%
filter(tissue == "ileum") %>%
select(group,INFg:TNFa) %>%
tbl_summary(by = group,
digits = everything() ~ c(2,1,1),
missing = "no",
include = !"INFg",
# statistic = list(all_continuous() ~ "{mean} ({sd})")  #Un-comment this line to get mean+sd.
#%>%
statistic = list(all_continuous() ~ "{mean} ({sd})")) %>%
add_p() %>%
modify_header(
label ~ "Cytokines") %>%
modify_spanning_header((c("stat_1", "stat_2", "stat_3", "stat_4") ~ "Treatment groups (N total = {N})")) %>%
modify_caption( "Exp 1") %>%
modify_footnote("Exp 1")
tbl1 <- cytokines %>%
filter(exp_number == "1") %>%
filter(tissue == "ileum") %>%
select(group,INFg:TNFa) %>%
tbl_summary(by = group,
digits = everything() ~ c(2,1,1),
missing = "no",
include = !"INFg",
# statistic = list(all_continuous() ~ "{mean} ({sd})")  #Un-comment this line to get mean+sd.
#%>%
statistic = list(all_continuous() ~ "{mean} ({sd})")) %>%
add_p() %>%
modify_header(
label ~ "Cytokines") %>%
modify_spanning_header((c("stat_1", "stat_2", "stat_3", "stat_4") ~ "Treatment groups (N total = {N})")) %>%
modify_footnote( "Exp 1")
tbl1 <- cytokines %>%
filter(exp_number == "1") %>%
filter(tissue == "ileum") %>%
select(group,INFg:TNFa) %>%
tbl_summary(by = group,
digits = everything() ~ c(2,1,1),
missing = "no",
include = !"INFg",
# statistic = list(all_continuous() ~ "{mean} ({sd})")  #Un-comment this line to get mean+sd.
#%>%
statistic = list(all_continuous() ~ "{mean} ({sd})")) %>%
add_p() %>%
add_overall() %>%
modify_header(
label ~ "Cytokines") %>%
modify_spanning_header((c("stat_1", "stat_2", "stat_3", "stat_4") ~ "Treatment groups (N total = {N})")) %>%
modify_footnote( "Exp 1")
tbl1
tbl1
tbl1 <- cytokines %>%
filter(exp_number == "1") %>%
filter(tissue == "ileum") %>%
select(group,INFg:TNFa) %>%
tbl_summary(by = group,
digits = everything() ~ c(2,1,1),
missing = "no",
include = !"INFg",
# statistic = list(all_continuous() ~ "{mean} ({sd})")  #Un-comment this line to get mean+sd.
#%>%
statistic = list(all_continuous() ~ "{mean} ({sd})")) %>%
add_overall() %>%
add_p() %>%
modify_header(
label ~ "Cytokines") %>%
modify_spanning_header((c("stat_1", "stat_2", "stat_3", "stat_4") ~ "Treatment groups (N total = {N})")) %>%
modify_footnote( "Exp 1")
tbl1 <- cytokines %>%
filter(exp_number == "1") %>%
filter(tissue == "ileum") %>%
select(group,INFg:TNFa) %>%
tbl_summary(by = group,
digits = everything() ~ c(2,1,1),
missing = "no",
include = !"INFg",
# statistic = list(all_continuous() ~ "{mean} ({sd})")  #Un-comment this line to get mean+sd.
#%>%
statistic = list(all_continuous() ~ "{mean} ({sd})")) %>%
add_p() %>%
modify_header(
label ~ "Cytokines") %>%
modify_spanning_header((c("stat_1", "stat_2", "stat_3", "stat_4") ~ "Treatment groups (N total = {N})"))
tbl1 <- cytokines %>%
filter(exp_number == "1") %>%
filter(tissue == "ileum") %>%
select(group,INFg:TNFa) %>%
tbl_summary(by = group,
digits = everything() ~ c(2,1,1),
missing = "no",
include = !"INFg",
# statistic = list(all_continuous() ~ "{mean} ({sd})")  #Un-comment this line to get mean+sd.
#%>%
statistic = list(all_continuous() ~ "{mean} ({sd})")) %>%
add_p() %>%
add_overall() %>%
modify_header(
label ~ "Cytokines") %>%
modify_spanning_header((c("stat_1", "stat_2", "stat_3", "stat_4") ~ "Treatment groups (N total = {N})"))
tbl1
tbl1 <- cytokines %>%
filter(exp_number == "1") %>%
filter(tissue == "ileum") %>%
select(group,INFg:TNFa) %>%
tbl_summary(by = group,
digits = everything() ~ c(2,1,1),
missing = "no",
include = !"INFg",
# statistic = list(all_continuous() ~ "{mean} ({sd})")  #Un-comment this line to get mean+sd.
#%>%
statistic = list(all_continuous() ~ "{mean} ({sd})")) %>%
add_p() %>%
modify_header(
label ~ "Cytokines") %>%
modify_spanning_header((c("stat_1", "stat_2", "stat_3", "stat_4") ~ "Treatment groups (N total = {N})")) %>%
modify_footnote("Exp. 1")
tbl1 <- cytokines %>%
filter(exp_number == "1") %>%
filter(tissue == "ileum") %>%
select(group,INFg:TNFa) %>%
tbl_summary(by = group,
digits = everything() ~ c(2,1,1),
missing = "no",
include = !"INFg",
# statistic = list(all_continuous() ~ "{mean} ({sd})")  #Un-comment this line to get mean+sd.
#%>%
statistic = list(all_continuous() ~ "{mean} ({sd})")) %>%
add_p() %>%
modify_footnote("Exp. 1") %>%
modify_header(
label ~ "Cytokines") %>%
modify_spanning_header((c("stat_1", "stat_2", "stat_3", "stat_4") ~ "Treatment groups (N total = {N})"))
tbl1
tbl1 <- cytokines %>%
filter(exp_number == "1") %>%
filter(tissue == "ileum") %>%
select(group,INFg:TNFa) %>%
tbl_summary(by = group,
digits = everything() ~ c(2,1,1),
missing = "no",
include = !"INFg",
# statistic = list(all_continuous() ~ "{mean} ({sd})")  #Un-comment this line to get mean+sd.
#%>%
statistic = list(all_continuous() ~ "{mean} ({sd})")) %>%
add_p() %>%
#modify_footnote("Exp. 1") %>%
modify_header(
label ~ "Cytokines") %>%
modify_spanning_header((c("stat_1", "stat_2", "stat_3", "stat_4") ~ "Treatment groups (N total = {N})"))
tbl1
tbl1_gt <- tbl1 %>%
as_gt() %>%
#tab_header(title = md("**Proinflammatory cytokines**")) %>%
opt_align_table_header("center") %>%
# tab_options(heading.title.font.size = 20,
#             heading.background.color = "lightgrey",
#             ) %>%
tab_source_note(
source_note = " * P-value indicates overall group differences"
) %>%
tab_source_note(
source_note = md("**Matrinem round 1**")
) %>%
cols_width(label ~ px(100),
stat_1 ~ px(150),
stat_2 ~ px(150),
stat_3 ~ px(150),
stat_4 ~ px(150))
tbl1_gt
tbl1_p <- tbl1 %>%
filter_p() %>%
as_tibble()
tbl1_p
To see all the cytokine leves plotted run this code:
plot_all_cytokines <- cytokines_long %>%
filter(tissue == sample_tissue) %>%
filter(!variables %in% "INFg") %>%  #Exclude any cytokines not wanted in the plot
ggplot(aes(x = group,
y = values,
fill = group)) +
geom_boxplot() +
facet_wrap(~variables,
scales = 'free',
nrow = 3,
ncol = 3) +
labs(title = "Levels of pro-inflammatory cytokines in the ileum",  # Change title, and axis names
x = "",
y = "Tissue conc. (pg/mg)",
fill = "Groups") +
theme_bw()+
theme(                   # Change the appearance of labels
plot.title = element_text(color="darkgrey", size=12, face="bold"),
axis.title.y = element_text(color="darkgrey", size=10, face="bold.italic"),
axis.text.y = element_blank(),
axis.ticks.x = element_blank(),  # Hide labels
axis.text.x = element_blank(),
legend.title = element_text(face="bold"),
legend.position="bottom",
legend.background = element_rect(fill="white")) + # Change legend box background color
scale_fill_brewer(palette="Set1")
plot_all_cytokines
plot_all_cytokines <- cytokines_long %>%
filter(exp_number == "1") %>%
filter(tissue == sample_tissue) %>%
filter(!variables %in% "INFg") %>%  #Exclude any cytokines not wanted in the plot
ggplot(aes(x = group,
y = values,
fill = group)) +
geom_boxplot() +
facet_wrap(~variables,
scales = 'free',
nrow = 3,
ncol = 3) +
labs(title = "Levels of pro-inflammatory cytokines in the ileum",  # Change title, and axis names
x = "",
y = "Tissue conc. (pg/mg)",
fill = "Groups") +
theme_bw()+
theme(                   # Change the appearance of labels
plot.title = element_text(color="darkgrey", size=12, face="bold"),
axis.title.y = element_text(color="darkgrey", size=10, face="bold.italic"),
axis.text.y = element_blank(),
axis.ticks.x = element_blank(),  # Hide labels
axis.text.x = element_blank(),
legend.title = element_text(face="bold"),
legend.position="bottom",
legend.background = element_rect(fill="white")) + # Change legend box background color
scale_fill_brewer(palette="Set1")
plot_all_cytokines
plot_all_cytokines <- cytokines_long %>%
filter(exp_number == "1") %>%
filter(tissue == sample_tissue) %>%
filter(!variables %in% "INFg") %>%  #Exclude any cytokines not wanted in the plot
ggplot(aes(x = group,
y = values,
fill = group)) +
geom_boxplot() +
facet_wrap(~variables,
scales = 'free',
nrow = 3,
ncol = 3) +
labs(title = "Levels of pro-inflammatory cytokines in the ileum",  # Change title, and axis names
x = "",
y = "Tissue conc. (pg/mg)",
fill = "Groups") +
theme_bw()+
theme(                   # Change the appearance of labels
plot.title = element_text(color="darkgrey", size=12, face="bold"),
axis.title.y = element_text(color="darkgrey", size=10, face="bold.italic"),
#axis.text.y = element_blank(),
axis.ticks.x = element_blank(),  # Hide labels
axis.text.x = element_blank(),
legend.title = element_text(face="bold"),
legend.position="bottom",
legend.background = element_rect(fill="white")) + # Change legend box background color
scale_fill_brewer(palette="Set1")
plot_all_cytokines
all_cytokines_patch <- plot_all_cytokines + plot_annotation (
title = 'Cytokine expression',
subtitle = 'All cytokines measured',
tag_levels = 'A',
caption = 'CON = Water, AB = Antibiotics, BF = Breast-Feeding, FF = Formula-Feeding',
theme = theme(plot.title = element_text(hjust = 0.5, size=14, face="bold"),
plot.subtitle = element_text(hjust = 0.5, face = "bold.italic"),
plot.caption = element_text(hjust = 0.5, size=7,face = "bold")))
all_cytokines_patch
plot_all_cytokines
plot_all_cytokines <- cytokines_long %>%
filter(exp_number == "1") %>%
filter(tissue == sample_tissue) %>%
#filter(!variables %in% "INFg") %>%  #Exclude any cytokines not wanted in the plot
ggplot(aes(x = group,
y = values,
fill = group)) +
geom_boxplot() +
facet_wrap(~variables,
scales = 'free',
nrow = 2,
ncol = 5) +
labs(title = "Levels of pro-inflammatory cytokines in the ileum",  # Change title, and axis names
x = "",
y = "Tissue conc. (pg/mg)",
fill = "Groups") +
theme_bw()+
theme(                   # Change the appearance of labels
plot.title = element_text(color="darkgrey", size=12, face="bold"),
axis.title.y = element_text(color="darkgrey", size=10, face="bold.italic"),
#axis.text.y = element_blank(),
axis.ticks.x = element_blank(),  # Hide labels
axis.text.x = element_blank(),
legend.title = element_text(face="bold"),
legend.position="bottom",
legend.background = element_rect(fill="white")) + # Change legend box background color
scale_fill_brewer(palette="Set1")
plot_all_cytokines
plot_all_cytokines <- cytokines_long %>%
filter(exp_number == "1") %>%
filter(tissue == sample_tissue) %>%
#filter(!variables %in% "INFg") %>%  #Exclude any cytokines not wanted in the plot
ggplot(aes(x = group,
y = values,
fill = group)) +
geom_boxplot() +
facet_wrap(~variables,
scales = 'free',
nrow = 5,
ncol = 2) +
labs(title = "Levels of pro-inflammatory cytokines in the ileum",  # Change title, and axis names
x = "",
y = "Tissue conc. (pg/mg)",
fill = "Groups") +
theme_bw()+
theme(                   # Change the appearance of labels
plot.title = element_text(color="darkgrey", size=12, face="bold"),
axis.title.y = element_text(color="darkgrey", size=10, face="bold.italic"),
#axis.text.y = element_blank(),
axis.ticks.x = element_blank(),  # Hide labels
axis.text.x = element_blank(),
legend.title = element_text(face="bold"),
legend.position="bottom",
legend.background = element_rect(fill="white")) + # Change legend box background color
scale_fill_brewer(palette="Set1")
plot_all_cytokines
ggsave('../../exports/exp1_cytokines.png',
plot_all_cytokines,
width = 8cm,
ggsave('../../exports/exp1_cytokines.png',
plot_all_cytokines,
width = 8 "cm",
ggsave('../../exports/exp1_cytokines.png',
plot_all_cytokines, width = 8 "cm",height = 16 "cm")
ggsave('../../exports/exp1_cytokines.png',
plot_all_cytokines, width = 8, height = 16, units = "cm")
