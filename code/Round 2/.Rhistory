facet_wrap(~variables,
scales = 'free',
nrow = 5,
ncol = 2) +
labs(title = "Levels of pro-inflammatory cytokines in the ileum",  # Change title, and axis names
x = "",
y = "Tissue conc.",
fill = "Groups",
caption = "Matrinem round 4") +
theme_bw()+
theme(                   # Change the appearance of labels
plot.title = element_text(color="darkgrey", size=12, face="bold"),
axis.title.y = element_text(color="darkgrey", size=10, face="bold.italic"),
axis.text.y = element_blank(),
axis.ticks.x = element_blank(),  # Hide labels
axis.text.x = element_blank(),
legend.title = element_text(face="bold"),
legend.position="bottom",
legend.background = element_rect(fill="lightgrey"), # Change legend box background color
plot.caption = element_text(color = "darkgrey", size=5)) +
scale_fill_brewer(palette="Set1")
cytokines_long %>%
#filter(!variables %in% "INFg") %>%  #Exclude any cytokines not wanted in the plot
ggplot(aes(x = group,
y = values,
fill = group)) +
geom_boxplot(outlier.shape = NA) +
coord_cartesian(ylim = quantile(cytokines_long$values, c(0.1, 0.9))) +
facet_wrap(~variables,
scales = 'free',
nrow = 5,
ncol = 2) +
labs(title = "Levels of pro-inflammatory cytokines in the ileum",  # Change title, and axis names
x = "",
y = "Tissue conc.",
fill = "Groups",
caption = "Matrinem round 4") +
theme_bw()+
theme(                   # Change the appearance of labels
plot.title = element_text(color="darkgrey", size=12, face="bold"),
axis.title.y = element_text(color="darkgrey", size=10, face="bold.italic"),
axis.text.y = element_blank(),
axis.ticks.x = element_blank(),  # Hide labels
axis.text.x = element_blank(),
legend.title = element_text(face="bold"),
legend.position="bottom",
legend.background = element_rect(fill="lightgrey"), # Change legend box background color
plot.caption = element_text(color = "darkgrey", size=5)) +
scale_fill_brewer(palette="Set1")
cytokines_long %>%
#filter(!variables %in% "INFg") %>%  #Exclude any cytokines not wanted in the plot
ggplot(aes(x = group,
y = values,
fill = group)) +
geom_boxplot(outlier.shape = NA) +
facet_wrap(~variables,
scales = 'free',
nrow = 5,
ncol = 2) +
coord_cartesian(ylim = quantile(cytokines_long$values, c(0.1, 0.9))) +
labs(title = "Levels of pro-inflammatory cytokines in the ileum",  # Change title, and axis names
x = "",
y = "Tissue conc.",
fill = "Groups",
caption = "Matrinem round 4") +
theme_bw()+
theme(                   # Change the appearance of labels
plot.title = element_text(color="darkgrey", size=12, face="bold"),
axis.title.y = element_text(color="darkgrey", size=10, face="bold.italic"),
axis.text.y = element_blank(),
axis.ticks.x = element_blank(),  # Hide labels
axis.text.x = element_blank(),
legend.title = element_text(face="bold"),
legend.position="bottom",
legend.background = element_rect(fill="lightgrey"), # Change legend box background color
plot.caption = element_text(color = "darkgrey", size=5)) +
scale_fill_brewer(palette="Set1")
plot_all_cytokines <- cytokines_long %>%
#filter(!variables %in% "INFg") %>%  #Exclude any cytokines not wanted in the plot
ggplot(aes(x = group,
y = values,
fill = group)) +
geom_boxplot(outlier.shape = NA) +
coord_cartesian(ylim = quantile(group_by(variables) %>%  cytokines_long$values, c(0.1, 0.9))) +
facet_wrap(~variables,
scales = 'free',
nrow = 5,
ncol = 2) +
labs(title = "Levels of pro-inflammatory cytokines in the ileum",  # Change title, and axis names
x = "",
y = "Tissue conc.",
fill = "Groups",
caption = "Matrinem round 4") +
theme_bw()+
theme(                   # Change the appearance of labels
plot.title = element_text(color="darkgrey", size=12, face="bold"),
axis.title.y = element_text(color="darkgrey", size=10, face="bold.italic"),
axis.text.y = element_blank(),
axis.ticks.x = element_blank(),  # Hide labels
axis.text.x = element_blank(),
legend.title = element_text(face="bold"),
legend.position="bottom",
legend.background = element_rect(fill="lightgrey"), # Change legend box background color
plot.caption = element_text(color = "darkgrey", size=5)) +
scale_fill_brewer(palette="Set1")
cytokines_long %>%
#filter(!variables %in% "INFg") %>%  #Exclude any cytokines not wanted in the plot
ggplot(aes(x = group,
y = values,
fill = group)) +
geom_boxplot(outlier.shape = NA) +
coord_cartesian(ylim = quantile(group_by(variables) %>%  cytokines_long$values, c(0.1, 0.9))) +
facet_wrap(~variables,
scales = 'free',
nrow = 5,
ncol = 2) +
labs(title = "Levels of pro-inflammatory cytokines in the ileum",  # Change title, and axis names
x = "",
y = "Tissue conc.",
fill = "Groups",
caption = "Matrinem round 4") +
theme_bw()+
theme(                   # Change the appearance of labels
plot.title = element_text(color="darkgrey", size=12, face="bold"),
axis.title.y = element_text(color="darkgrey", size=10, face="bold.italic"),
axis.text.y = element_blank(),
axis.ticks.x = element_blank(),  # Hide labels
axis.text.x = element_blank(),
legend.title = element_text(face="bold"),
legend.position="bottom",
legend.background = element_rect(fill="lightgrey"), # Change legend box background color
plot.caption = element_text(color = "darkgrey", size=5)) +
scale_fill_brewer(palette="Set1")
plot_all_cytokines <- cytokines_long %>%
#filter(!variables %in% "INFg") %>%  #Exclude any cytokines not wanted in the plot
ggplot(aes(x = group,
y = values,
fill = group)) +
geom_boxplot(outlier.shape = NA) +
facet_wrap(~variables,
scales = 'free',
nrow = 5,
ncol = 2) +
labs(title = "Levels of pro-inflammatory cytokines in the ileum",  # Change title, and axis names
x = "",
y = "Tissue conc.",
fill = "Groups",
caption = "Matrinem round 4") +
theme_bw()+
theme(                   # Change the appearance of labels
plot.title = element_text(color="darkgrey", size=12, face="bold"),
axis.title.y = element_text(color="darkgrey", size=10, face="bold.italic"),
axis.text.y = element_blank(),
axis.ticks.x = element_blank(),  # Hide labels
axis.text.x = element_blank(),
legend.title = element_text(face="bold"),
legend.position="bottom",
legend.background = element_rect(fill="lightgrey"), # Change legend box background color
plot.caption = element_text(color = "darkgrey", size=5)) +
scale_fill_brewer(palette="Set1")
plot_all_cytokines <- cytokines_long %>%
#filter(!variables %in% "INFg") %>%  #Exclude any cytokines not wanted in the plot
ggplot(aes(x = group,
y = values,
fill = group)) +
geom_boxplot(outlier.shape = NA) +
facet_wrap(~variables,
scales = 'free',
nrow = 5,
ncol = 2) +
labs(title = "Levels of pro-inflammatory cytokines in the ileum",  # Change title, and axis names
x = "",
y = "Tissue conc.",
fill = "Groups",
caption = "Matrinem round 4") +
theme_bw()+
theme(                   # Change the appearance of labels
plot.title = element_text(color="darkgrey", size=12, face="bold"),
axis.title.y = element_text(color="darkgrey", size=10, face="bold.italic"),
axis.text.y = element_blank(),
axis.ticks.x = element_blank(),  # Hide labels
axis.text.x = element_blank(),
legend.title = element_text(face="bold"),
legend.position="bottom",
legend.background = element_rect(fill="lightgrey"), # Change legend box background color
plot.caption = element_text(color = "darkgrey", size=5)) +
scale_fill_brewer(palette="Set1")
plot_all_cytokines
plot_all_cytokines <- cytokines_long %>%
#filter(!variables %in% "INFg") %>%  #Exclude any cytokines not wanted in the plot
ggplot(aes(x = group,
y = values,
fill = group)) +
geom_boxplot(outlier.shape = NA) +
facet_wrap(~variables,
scales = 'free',
nrow = 5,
ncol = 2) +
labs(title = "Levels of pro-inflammatory cytokines in the ileum",  # Change title, and axis names
x = "",
y = "Tissue conc.",
fill = "Groups",
caption = "Matrinem round 4") +
theme_bw()+
theme(                   # Change the appearance of labels
plot.title = element_text(color="darkgrey", size=12, face="bold"),
axis.title.y = element_text(color="darkgrey", size=10, face="bold.italic"),
axis.text.y = element_blank(),
axis.ticks.x = element_blank(),  # Hide labels
axis.text.x = element_blank(),
legend.title = element_text(face="bold"),
legend.position="bottom",
legend.background = element_rect(fill="lightgrey"), # Change legend box background color
plot.caption = element_text(color = "darkgrey", size=5)) +
scale_fill_brewer(palette="Set1")
all_cytokines_patch <- plot_all_cytokines + plot_annotation (
title = 'Cytokine expression',
subtitle = 'All cytokines measured',
tag_levels = 'A',
caption = 'VANCO = Vancomycin, BF = Breast-Feeding, FF = Formula-Feeding\n
FVT = Fecal Virome Transfer, SM = SM-buffer',
theme = theme(plot.title = element_text(hjust = 0.5, size=14, face="bold"),
plot.subtitle = element_text(hjust = 0.5, face = "bold.italic"),
plot.caption = element_text(hjust = 0.5, size=7,face = "bold")))
all_cytokines_patch
signif_cytokines <- cytokines_long %>%
filter(variables %in% tbl1_p$Cytokines) %>%  #Exclude any cytokines not wanted in the plot
ggplot(aes(x = group,
y = values,
fill = group)) +
geom_boxplot() +
stat_compare_means(aes(label = ..p.signif..),
method = "wilcox.test", ref.group = "CON-BF",
label.y.npc = 0.55) +
stat_compare_means(
aes(label = paste0("Kruskal-Wallis \n p = ", ..p.format..)),
label.y.npc = 0.9,
label.x.npc = 0.5) +
facet_wrap(~variables,
scales = 'free',
nrow = 3,
ncol = 3) +
labs(title = "Levels of pro-inflammatory cytokines in the ileum", # Change title, and axis names
#subtitle = "Statistically significant changes",
x = "",
y = "Tissue conc. (pg/mg)",
fill = "Groups",
caption = "Matrinem round 2") +
theme_bw()+
theme(                   # Change the appearance of labels
plot.title = element_text(color="darkgrey", size=12, face="bold"),
axis.title.y = element_text(color="darkgrey", size=10, face="bold.italic"),
axis.text.y = element_blank(),
axis.ticks.x = element_blank(),  # Hide labels
axis.text.x = element_blank(),
legend.title = element_text(face="bold"),
legend.position="bottom",
legend.background = element_rect(fill="white")) + # Change legend box background color
scale_fill_brewer(palette="Set1")
signif_cytokines_patch <- signif_cytokines + plot_annotation (
title = 'Cytokine expression',
subtitle = 'Statistically significant changes',
tag_levels = 'A',
caption = 'CON = Water, AB = Antibiotics, BF = Breast-Feeding, FF = Formula-Feeding. \n
Pairwise comparisons with CON-BF using wilcoxon test',
theme = theme(plot.title = element_text(hjust = 0.5, size=14, face="bold"),
plot.subtitle = element_text(hjust = 0.5, face = "bold.italic"),
plot.caption = element_text(hjust = 0.5, size=7,face = "bold")))
signif_cytokines_patch
signif_cytokines <- cytokines_long %>%
filter(variables %in% tbl1_p$Cytokines) %>%  #Exclude any cytokines not wanted in the plot
ggplot(aes(x = group,
y = values,
fill = group)) +
geom_boxplot() +
stat_compare_means(aes(label = ..p.signif..),
method = "wilcox.test", ref.group = "CON-BF",
label.y.npc = 0.55) +
stat_compare_means(
aes(label = paste0("Kruskal-Wallis \n p = ", ..p.format..)),
label.y.npc = 0.9,
label.x.npc = 0.5) +
facet_wrap(~variables,
scales = 'free',
nrow = 3,
ncol = 3) +
labs(title = "Levels of pro-inflammatory cytokines in the ileum", # Change title, and axis names
#subtitle = "Statistically significant changes",
x = "",
y = "Tissue conc. (pg/mg)",
fill = "Groups",
caption = "Matrinem round 4") +
theme_bw()+
theme(                   # Change the appearance of labels
plot.title = element_text(color="darkgrey", size=12, face="bold"),
axis.title.y = element_text(color="darkgrey", size=10, face="bold.italic"),
axis.text.y = element_blank(),
axis.ticks.x = element_blank(),  # Hide labels
axis.text.x = element_blank(),
legend.title = element_text(face="bold"),
legend.position="bottom",
legend.background = element_rect(fill="white")) + # Change legend box background color
scale_fill_brewer(palette="Set1")
signif_cytokines <- cytokines_long %>%
filter(variables %in% tbl1_p$Cytokines) %>%  #Exclude any cytokines not wanted in the plot
ggplot(aes(x = group,
y = values,
fill = group)) +
geom_boxplot() +
stat_compare_means(aes(label = ..p.signif..),
method = "wilcox.test", ref.group = "CON-BF",
label.y.npc = 0.55) +
stat_compare_means(
aes(label = paste0("Kruskal-Wallis \n p = ", ..p.format..)),
label.y.npc = 0.9,
label.x.npc = 0.5) +
facet_wrap(~variables,
scales = 'free',
nrow = 3,
ncol = 3) +
labs(title = "Levels of pro-inflammatory cytokines in the ileum", # Change title, and axis names
#subtitle = "Statistically significant changes",
x = "",
y = "Tissue conc. (pg/mg)",
fill = "Groups",
caption = "Matrinem round 4") +
theme_bw()+
theme(                   # Change the appearance of labels
plot.title = element_text(color="darkgrey", size=12, face="bold"),
axis.title.y = element_text(color="darkgrey", size=10, face="bold.italic"),
axis.text.y = element_blank(),
axis.ticks.x = element_blank(),  # Hide labels
axis.text.x = element_blank(),
legend.title = element_text(face="bold"),
legend.position="bottom",
legend.background = element_rect(fill="white")) + # Change legend box background color
scale_fill_brewer(palette="Set1")
signif_cytokines_patch <- signif_cytokines + plot_annotation (
title = 'Cytokine expression',
subtitle = 'Statistically significant changes',
tag_levels = 'A',
caption = 'VANCO = Vancomycin, BF = Breast-Feeding, FF = Formula-Feeding\n
FVT = Fecal Virome Transfer, SM = SM-buffer',
theme = theme(plot.title = element_text(hjust = 0.5, size=14, face="bold"),
plot.subtitle = element_text(hjust = 0.5, face = "bold.italic"),
plot.caption = element_text(hjust = 0.5, size=7,face = "bold")))
signif_cytokines_patch
all_cytokines_patch
cytokines_long <- cytokines %>%
filter(exp_number == study_round) %>%
filter(tissue == sample_tissue) %>%
pivot_longer(.,
cols = INFg:TNFa ,
names_to = "variables",
values_to = "values"
) %>%
drop_na(
values) %>%
# mutate(MAT = ifelse(str_detect(group,'AB'),'AB',
#                                 ifelse(str_detect(group,'CON'),'CON', "miss")),
#        FEED = ifelse(str_detect(group,'FF'),'FF',
#                                 ifelse(str_detect(group,'BF'),'BF', "miss"))) %>%
mutate(
group = recode_factor(  #Change the order of the groups to desired plot order
group,
"VANCO-BF"= "VANCO-BF",
"VANCO-FF (FVT)" = "VANCO-FORM+FVT",
"VANCO-FF (SM)"= "VANCO-FORM+SM"
))
head(cytokines_long)
cytokines_long <- cytokines %>%
filter(exp_number == study_round) %>%
filter(tissue == sample_tissue) %>%
pivot_longer(.,
cols = INFg:TNFa ,
names_to = "variables",
values_to = "values"
) %>%
drop_na(
values) %>%
# mutate(MAT = ifelse(str_detect(group,'AB'),'AB',
#                                 ifelse(str_detect(group,'CON'),'CON', "miss")),
#        FEED = ifelse(str_detect(group,'FF'),'FF',
#                                 ifelse(str_detect(group,'BF'),'BF', "miss"))) %>%
mutate(
group = recode_factor(#Change the order of the groups to desired plot order
group,
"VANCO-BF"= "VANCO-BF",
"VANCO-FORM+FVT" = "VANCO-FF (FVT)",
"VANCO-FORM+SM" = "VANCO-FF (SM)"
))
plot_all_cytokines <- cytokines_long %>%
#filter(!variables %in% "INFg") %>%  #Exclude any cytokines not wanted in the plot
ggplot(aes(x = group,
y = values,
fill = group)) +
geom_boxplot(outlier.shape = NA) +
facet_wrap(~variables,
scales = 'free',
nrow = 5,
ncol = 2) +
labs(title = "Levels of pro-inflammatory cytokines in the ileum",  # Change title, and axis names
x = "",
y = "Tissue conc.",
fill = "Groups",
caption = "Matrinem round 4") +
theme_bw()+
theme(                   # Change the appearance of labels
plot.title = element_text(color="darkgrey", size=12, face="bold"),
axis.title.y = element_text(color="darkgrey", size=10, face="bold.italic"),
axis.text.y = element_blank(),
axis.ticks.x = element_blank(),  # Hide labels
axis.text.x = element_blank(),
legend.title = element_text(face="bold"),
legend.position="bottom",
legend.background = element_rect(fill="lightgrey"), # Change legend box background color
plot.caption = element_text(color = "darkgrey", size=5)) +
scale_fill_brewer(palette="Set1")
all_cytokines_patch <- plot_all_cytokines + plot_annotation (
title = 'Cytokine expression',
subtitle = 'All cytokines measured',
tag_levels = 'A',
caption = 'VANCO = Vancomycin, BF = Breast-Feeding, FF = Formula-Feeding\n
FVT = Fecal Virome Transfer, SM = SM-buffer',
theme = theme(plot.title = element_text(hjust = 0.5, size=14, face="bold"),
plot.subtitle = element_text(hjust = 0.5, face = "bold.italic"),
plot.caption = element_text(hjust = 0.5, size=7,face = "bold")))
all_cytokines_patch
plot_all_cytokines <- cytokines_long %>%
#filter(!variables %in% "INFg") %>%  #Exclude any cytokines not wanted in the plot
ggplot(aes(x = group,
y = values,
fill = group)) +
geom_boxplot() +
facet_wrap(~variables,
scales = 'free',
nrow = 5,
ncol = 2) +
labs(title = "Levels of pro-inflammatory cytokines in the ileum",  # Change title, and axis names
x = "",
y = "Tissue conc.",
fill = "Groups",
caption = "Matrinem round 4") +
theme_bw()+
theme(                   # Change the appearance of labels
plot.title = element_text(color="darkgrey", size=12, face="bold"),
axis.title.y = element_text(color="darkgrey", size=10, face="bold.italic"),
axis.text.y = element_blank(),
axis.ticks.x = element_blank(),  # Hide labels
axis.text.x = element_blank(),
legend.title = element_text(face="bold"),
legend.position="bottom",
legend.background = element_rect(fill="lightgrey"), # Change legend box background color
plot.caption = element_text(color = "darkgrey", size=5)) +
scale_fill_brewer(palette="Set1")
all_cytokines_patch <- plot_all_cytokines + plot_annotation (
title = 'Cytokine expression',
subtitle = 'All cytokines measured',
tag_levels = 'A',
caption = 'VANCO = Vancomycin, BF = Breast-Feeding, FF = Formula-Feeding\n
FVT = Fecal Virome Transfer, SM = SM-buffer',
theme = theme(plot.title = element_text(hjust = 0.5, size=14, face="bold"),
plot.subtitle = element_text(hjust = 0.5, face = "bold.italic"),
plot.caption = element_text(hjust = 0.5, size=7,face = "bold")))
all_cytokines_patch
signif_cytokines <- cytokines_long %>%
filter(variables %in% tbl1_p$Cytokines) %>%  #Exclude any cytokines not wanted in the plot
ggplot(aes(x = group,
y = values,
fill = group)) +
geom_boxplot() +
stat_compare_means(aes(label = ..p.signif..),
method = "wilcox.test", ref.group = "CON-BF",
label.y.npc = 0.55) +
stat_compare_means(
aes(label = paste0("Kruskal-Wallis \n p = ", ..p.format..)),
label.y.npc = 0.9,
label.x.npc = 0.5) +
facet_wrap(~variables,
scales = 'free',
nrow = 3,
ncol = 3) +
labs(title = "Levels of pro-inflammatory cytokines in the ileum", # Change title, and axis names
#subtitle = "Statistically significant changes",
x = "",
y = "Tissue conc. (pg/mg)",
fill = "Groups",
caption = "Matrinem round 4") +
theme_bw()+
theme(                   # Change the appearance of labels
plot.title = element_text(color="darkgrey", size=12, face="bold"),
axis.title.y = element_text(color="darkgrey", size=10, face="bold.italic"),
axis.text.y = element_blank(),
axis.ticks.x = element_blank(),  # Hide labels
axis.text.x = element_blank(),
legend.title = element_text(face="bold"),
legend.position="bottom",
legend.background = element_rect(fill="white")) + # Change legend box background color
scale_fill_brewer(palette="Set1")
signif_cytokines_patch <- signif_cytokines + plot_annotation (
title = 'Cytokine expression',
subtitle = 'Statistically significant changes',
tag_levels = 'A',
caption = 'VANCO = Vancomycin, BF = Breast-Feeding, FF = Formula-Feeding\n
FVT = Fecal Virome Transfer, SM = SM-buffer',
theme = theme(plot.title = element_text(hjust = 0.5, size=14, face="bold"),
plot.subtitle = element_text(hjust = 0.5, face = "bold.italic"),
plot.caption = element_text(hjust = 0.5, size=7,face = "bold")))
signif_cytokines_patch
all_cytokines_patch
rm_ls
clean_cache()
