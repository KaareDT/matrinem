geom_bar(stat = "identity") +
labs(title =  "Ileum AB staining % of total tissue", subtitle = "No subtitle",
y = "% of tissue AB stained (mucin thickness?)",
x = "Treatment groups") +
theme_bw()
histo %>%  ### Try to wrap histo longer to have all stain values in 1 column and facet-wrap by PAS + AB
filter(TISSUE == "ileum" & exp_number == "4") %>%
group_by(group2) %>%
summarise(mean = mean(`AB-RELATIVE-TO-TOTAL(%)`)) %>%
ggplot(
aes(x = group2,
y = mean,
fill = group2,
legend = NA)) +
geom_bar(stat = "identity") +
labs(title =  "Ileum AB staining % of total tissue", subtitle = "No subtitle",
y = "% of tissue AB stained (mucin thickness?)",
x = "Treatment groups") +
theme_bw()
histo %>%  ### Try to wrap histo longer to have all stain values in 1 column and facet-wrap by PAS + AB
filter(TISSUE == "ileum" & exp_number == "4") %>%
group_by(group2) %>%
summarise(mean = mean(`AB-RELATIVE-TO-TOTAL(%)`)) %>%
ggplot(
aes(x = group2,
y = mean,
fill = group2,
legend = "NA")) +
geom_bar(stat = "identity") +
labs(title =  "Ileum AB staining % of total tissue", subtitle = "No subtitle",
y = "% of tissue AB stained (mucin thickness?)",
x = "Treatment groups") +
theme_bw()
histo %>%  ### Try to wrap histo longer to have all stain values in 1 column and facet-wrap by PAS + AB
filter(TISSUE == "ileum" & exp_number == "4") %>%
group_by(group2) %>%
summarise(mean = mean(`AB-RELATIVE-TO-TOTAL(%)`)) %>%
ggplot(
aes(x = group2,
y = mean,
fill = group2,
legend = F)) +
geom_bar(stat = "identity") +
labs(title =  "Ileum AB staining % of total tissue", subtitle = "No subtitle",
y = "% of tissue AB stained (mucin thickness?)",
x = "Treatment groups") +
theme_bw()
tissue <- "ileum"
round <- "4"
histo %>%
filter(TISSUE == tissue & exp_number == round)
histo %>%
filter(TISSUE == tissue & exp_number == round) %>%
group_by(group2) %>%
summarise(mean = mean(`AB-RELATIVE-TO-TOTAL(%)`))
####Boxplot char
histo %>%
filter(TISSUE == tissue & exp_number == round) %>%
group_by(group2) %>%
summarise(mean = mean(`AB-RELATIVE-TO-TOTAL(%)`)) %>%
ggplot(
aes(x = group2
,y = mean
,fill = group2
)) +
geom_boxplot() +
labs(title =  "Ileum AB staining % of total tissue", subtitle = "No subtitle",
y = "% of tissue AB stained (mucin thickness?)",
x = "Treatment groups") +
theme_bw()
####Boxplot char
histo %>%
filter(TISSUE == tissue & exp_number == round) %>%
ggplot(
aes(x = group2
,y = `AB-RELATIVE-TO-TOTAL(%)`
,fill = group2
)) +
geom_boxplot() +
labs(title =  "Ileum AB staining % of total tissue", subtitle = "No subtitle",
y = "% of tissue AB stained (mucin thickness?)",
x = "Treatment groups") +
theme_bw()
tissue <- "ileum | colon"
####Bar char
histo %>%
filter(TISSUE == tissue & exp_number == round) %>%
group_by(group2) %>%
summarise(mean = mean(`AB-RELATIVE-TO-TOTAL(%)`)) %>%
ggplot(
aes(x = group2
,y = mean
,fill = group2
)) +
geom_bar(stat = "identity") +
labs(title =  "Ileum AB staining % of total tissue", subtitle = "No subtitle",
y = "% of tissue AB stained (mucin thickness?)",
x = "Treatment groups") +
theme_bw()
tissue <- "ileum"
tissue <- "colon"
round <- "4"
####Bar char
histo %>%
filter(TISSUE == tissue & exp_number == round) %>%
group_by(group2) %>%
summarise(mean = mean(`AB-RELATIVE-TO-TOTAL(%)`)) %>%
ggplot(
aes(x = group2
,y = mean
,fill = group2
)) +
geom_bar(stat = "identity") +
labs(title =  "Ileum AB staining % of total tissue", subtitle = "No subtitle",
y = "% of tissue AB stained (mucin thickness?)",
x = "Treatment groups") +
theme_bw()
####Bar char
histo %>%
filter(TISSUE == tissue & exp_number == round) %>%
group_by(group2) %>%
summarise(mean = mean(`AB-RELATIVE-TO-TOTAL(%)`)) %>%
ggplot(
aes(x = group2
,y = mean
,fill = group2
)) +
geom_bar(stat = "identity") +
labs(title =  paste(tissue ,"AB staining % of total tissue"), subtitle = "No subtitle",
y = "% of tissue AB stained (mucin thickness?)",
x = "Treatment groups") +
theme_bw()
####Bar char
histo %>%
filter(TISSUE == tissue & exp_number == round) %>%
group_by(group2) %>%
summarise(mean = mean(`AB-RELATIVE-TO-TOTAL(%)`)) %>%
ggplot(
aes(x = group2
,y = mean
,fill = group2
)) +
geom_bar(stat = "identity") +
labs(title =  paste(tissue ,"AB staining % of total tissue"), subtitle = tissue,
y = "% of tissue AB stained (mucin thickness?)",
x = "Treatment groups") +
theme_bw()
####Bar char
histo %>%
filter(TISSUE == tissue & exp_number == round) %>%
group_by(group2) %>%
summarise(mean = mean(`AB-RELATIVE-TO-TOTAL(%)`)) %>%
ggplot(
aes(x = group2
,y = mean
,fill = group2
)) +
geom_bar(stat = "identity") +
labs(title =  paste(tissue ,"AB staining % of total tissue"), subtitle = tissue,
y = "% of tissue AB stained (mucin thickness?)",
x = "Treatment groups") +
theme_bw()
####Boxplot char
histo %>%
filter(TISSUE == tissue & exp_number == round) %>%
ggplot(
aes(x = group2
,y = `AB-RELATIVE-TO-TOTAL(%)`
,fill = group2
)) +
geom_boxplot() +
labs(title =  paste(tissue ,"AB staining % of total tissue"), subtitle = "No subtitle",
y = "% of tissue AB stained (mucin thickness?)",
x = "Treatment groups") +
theme_bw()
library(readxl)
library(tidyverse)
library(gt)
library(gtsummary)
library(broom)
library(rstatix)
library(knitr)
library(patchwork)
library(ggpubr)
# Import dataset
fitc <- read_excel("../../Data/CleanData/fitc.xlsx") %>%
rename(values = `result_µg/ml_undiluted`) %>%
drop_na(values)
glimpse(fitc)
View(fitc)
normality_check <- fitc %>%
filter(exp_number == 4) %>%
group_by(group) %>%
shapiro_test(values)
View(normality_check)
normality_check
normality_check <- fitc %>%
filter(exp_number == 4) %>%
group_by(group) %>%
shapiro_test(values) %>%
ungroup()
normality_check
normality_check <- fitc %>%
filter(exp_number == 4) %>%
group_by(group) %>%
shapiro_test(values) %>%
mutate(n = n())
normality_check
normality_check <- fitc %>%
filter(exp_number == 4) %>%
group_by(group) %>%
shapiro_test(values) %>%
mutate(n = n(sample_id))
normality_check <- fitc %>%
filter(exp_number == 4) %>%
group_by(group) %>%
shapiro_test(values) %>%
ungroup() %>%
mutate(n = n(sample_id))
normality_check <- fitc %>%
filter(exp_number == 4) %>%
group_by(group) %>%
mutate(stats = shapiro_test(values)) %>%
ungroup() %>%
group_by(group) %>%
mutate(n = n(group))
normality_check <- fitc %>%
filter(exp_number == 4) %>%
group_by(group) %>%
mutate(stats = shapiro_test(values)) %>%
ungroup() %>%
group_by(group) %>%
mutate(n = n())
normality_check
View(normality_check)
normality_check <- fitc %>%
filter(exp_number == 4) %>%
group_by(group) %>%
mutate(stats = shapiro_test(values)) %>%
ungroup() %>%
group_by(group) %>%
mutate(n = n()) %>%
ungroup()
normality_check <- fitc %>%
filter(exp_number == 4) %>%
group_by(group) %>%
do(tidy(shapiro.test(.$value))) %>%
ungroup()
normality_check <- fitc %>%
filter(exp_number == 4) %>%
group_by(group) %>%
do(tidy(shapiro.test(.$p.value))) %>%
ungroup()
normality_check <- fitc %>%
filter(exp_number == 4) %>%
group_by(group) %>%
do(tidy(shapiro.test(.$values))) %>%
ungroup()
View(normality_check)
View(normality_check)
normality_check <- fitc %>%
filter(exp_number == 4) %>%
group_by(group) %>%
do(tidy(shapiro.test(.$values))) %>%
ungroup() %>%
group_by(group) %>%
mutate(n = n()) %>%
ungroup()
View(normality_check)
normality_check <- fitc %>%
filter(exp_number == 4) %>%
group_by(group) %>%
mutate(stat = do(tidy(shapiro.test(.$values)))) %>%
ungroup
normality_check <- fitc %>%
filter(exp_number == 4) %>%
group_by(group) %>%
do(tidy(shapiro.test(.$value))) %>%
mutate(stats = shapiro_test(values)) %>%
ungroup()
normality_check <- fitc %>%
filter(exp_number == 4) %>%
group_by(group) %>%
mutate(stats = shapiro_test(values)) %>%
ungroup()
View(normality_check)
normality_check <- fitc %>%
filter(exp_number == 4) %>%
group_by(group) %>%
mutate(stats = shapiro_test(values)) %>%
ungroup() %>%
names()
normality_check <- fitc %>%
filter(exp_number == 4) %>%
group_by(group) %>%
mutate(stats = shapiro_test(values)) %>%
ungroup()
fitc %>%
filter(exp_number == 4) %>%
group_by(group) %>%
mutate(stats = shapiro_test(values)) %>%
ungroup() %>%
names()
fitc %>%
filter(exp_number == 4) %>%
group_by(group) %>%
mutate(stats = select(stats$p.value(shapiro_test(values))))
normality_check <- fitc %>%
filter(exp_number == 4) %>%
group_by(group) %>%
mutate(stats = shapiro_test(values)) %>%
ungroup() %>%
mutate(stats = normality_check$stats.p.value)
normality_check <- fitc %>%
filter(exp_number == 4) %>%
group_by(group) %>%
shapiro_test(values)
normality_check %>%
filter(p < 0.05)
#Density plots. Works
fitc %>%
filter(exp_number == 4) %>%
ggplot(aes(x = values, fill = group)) +
geom_density() +
facet_wrap(~ group,
scales = "free")
#Jitter plots. Works
fitc %>%
filter(exp_number == 4) %>%
ggplot(aes(x = group, y = values)) +
geom_jitter() +
facet_wrap(~ group,
scales = "free")
tbl1 <- fitc %>%
filter(exp_number == 4) %>%
mutate(Log10_values = log10(values)) %>%
select(group, values, Log10_values) %>%
tbl_summary(by = group,
digits = everything() ~ c(2,1,1),
missing = "no",
#type = list(values ~ 'continuous2', Log10_values ~ 'continuous2'),
statistic = list(values ~ "{median} ({p25}, {p75})", Log10_values ~"{median} ({p25}, {p75})"),
label = list(values ~ "µg/mL", Log10_values ~ "Log transformed")) %>%
add_p(list(values ~ "kruskal.test", Log10_values ~ "kruskal.test")) %>%
# modify_table_styling(
#   columns = label,
#   rows = label == "µg/mL",
#   footnote = "Non-parametric distribution"
# ) %>%
modify_header(
label = "FITC Conc.",
stat_1 = "**VANCO-BF (CON)**\n(n = {n})",
stat_2 = "**VANCO-FF (FVT)**\n(n = {n})",
stat_3 = "**VANCO-FF (SM)**\n(n = {n})") %>%
modify_spanning_header((c("stat_1", "stat_2", "stat_3") ~ "Treatment groups (N total = {N})")) %>%
bold_labels()
tbl1_gt <- tbl1 %>%
as_gt(include = -tab_footnote) %>%
tab_footnote(
footnote = md("Log transformation did not normalize distribution.  \n  Non-parametric test (Kruskall-Wallis) used for both datasets."),
locations = cells_column_labels(columns = c(p.value))
) %>%
tab_header(title = md("**Intestinal permeability**")) %>%
opt_align_table_header("center") %>%
tab_options(heading.title.font.size = 20,
heading.background.color = "lightgrey"
) %>%
# tab_source_note(
#   source_note = " µg/mL values"
# ) %>%
tab_source_note(
source_note = md("**Matrinem round 4**")
) %>%
cols_width(label ~ px(100),
stat_1 ~ px(150),
stat_2 ~ px(150),
stat_3 ~ px(150))
tbl1_gt
fitc_long <- fitc %>%
filter(exp_number == 4)%>%
drop_na(
values) %>%
mutate(Log10_values = log10(values)) %>%
mutate(
group = recode_factor(#Change the order of the groups to desired plot order
group,
"CON-BF"= "VANCO-BF",
"FVT-FORM" = "VANCO-FF (FVT)",
"SM-FORM" = "VANCO-FF (SM)"
))
head(fitc_long)
my_comparisons <- list(c("VANCO-BF", "VANCO-FF (FVT)"), c("VANCO-BF", "VANCO-FF (SM)"), c("VANCO-FF (FVT)", "VANCO-FF (SM)"))
plot_all_fitc <- fitc_long %>%
ggplot(aes(x = group,
y = values,
fill = group)) +
geom_boxplot() +
geom_point() +
#coord_cartesian(ylim = c(1.5, 16)) +
stat_compare_means(comparisons = my_comparisons, label.y = c(60, 50, 45), method = "wilcox.test") +
stat_compare_means(aes(label = paste0("Kruskal-Wallis \n p = ", ..p.format..)),
label.y.npc = 0.75,
label.x.npc = 0.55) +
labs( # Change title, and axis names
x = "",
y = "Serum FITC conc. (µg/ml)",
fill = "Groups",
caption = "Matrinem round 4") +
theme_bw()+
theme(                   # Change the appearance of labels
plot.title = element_text(color="darkgrey", size=12, face="bold"),
axis.title.y = element_text(color="darkgrey", size=10, face="bold.italic"),
#axis.text.y = element_blank(),
axis.ticks.x = element_blank(),  # Hide labels
axis.text.x = element_blank(),
legend.title = element_text(face="bold"),
legend.position="bottom",
legend.background = element_rect(fill="lightgrey"),#Change legend box background color
plot.caption = element_text(color = "darkgrey", size=5)) +
scale_fill_brewer(palette="Set1")
all_fitc_patch <- plot_all_fitc + plot_annotation (
title = 'Intestinal permeability',
#subtitle = 'All fitc measured',
#tag_levels = 'A',
caption = 'VANCO = Vancomycin, BF = Breast-Feeding, FF = Formula-Feeding\n
FVT = Fecal Virome Transfer, SM = SM-buffer',
theme = theme(plot.title = element_text(hjust = 0.5, size=14, face="bold"),
plot.subtitle = element_text(hjust = 0.5, face = "bold.italic"),
plot.caption = element_text(hjust = 0.5, size=7,face = "bold")))
all_fitc_patch
plot_all_fitc_log10 <- fitc_long %>%
ggplot(aes(x = group,
y = Log10_values,
fill = group)) +
geom_boxplot() +
geom_point() +
#coord_cartesian(ylim = c(1.5, 16)) +
stat_compare_means(comparisons = my_comparisons, label.y = c(2.5, 2.2, 2), method = "wilcox.test")+
stat_compare_means(aes(label = paste0("Anova \n p = ", ..p.format..)),
label.y.npc = 0.75,
label.x.npc = 0.55, method = "aov") +
labs( # Change title, and axis names
x = "",
y = "Serum FITC conc. log10 transformed",
fill = "Groups",
caption = "Matrinem round 2 and 3") +
theme_bw()+
theme(                   # Change the appearance of labels
plot.title = element_text(color="darkgrey", size=12, face="bold"),
axis.title.y = element_text(color="darkgrey", size=10, face="bold.italic"),
#axis.text.y = element_blank(),
axis.ticks.x = element_blank(),  # Hide labels
axis.text.x = element_blank(),
legend.title = element_text(face="bold"),
legend.position="bottom",
legend.background = element_rect(fill="lightgrey"),#Change legend box background color
plot.caption = element_text(color = "darkgrey", size=5)) +
scale_fill_brewer(palette="Set1")
all_fitc_patch_log10 <- plot_all_fitc_log10 + plot_annotation (
title = 'Intestinal permeability',
#subtitle = 'All fitc measured',
#tag_levels = 'A',
caption = 'VANCO = Vancomycin, BF = Breast-Feeding, FF = Formula-Feeding\n
FVT = Fecal Virome Transfer, SM = SM-buffer',
theme = theme(plot.title = element_text(hjust = 0.5, size=14, face="bold"),
plot.subtitle = element_text(hjust = 0.5, face = "bold.italic"),
plot.caption = element_text(hjust = 0.5, size=7,face = "bold")))
all_fitc_patch_log10
all_fitc_patch
FITC_PATCH <- all_fitc_patch + all_fitc_patch_log10
FITC_PATCH
plot_all_fitc_log10 <- fitc_long %>%
ggplot(aes(x = group,
y = Log10_values,
fill = group)) +
geom_boxplot() +
geom_point() +
#coord_cartesian(ylim = c(1.5, 16)) +
stat_compare_means(comparisons = my_comparisons, label.y = c(2.5, 2.2, 2), method = "wilcox.test")+
stat_compare_means(aes(label = paste0("\n p = ", ..p.format..)),
label.y.npc = 0.75,
label.x.npc = 0.55) +
labs( # Change title, and axis names
x = "",
y = "Serum FITC conc. log10 transformed",
fill = "Groups",
caption = "Matrinem round 2 and 3") +
theme_bw()+
theme(                   # Change the appearance of labels
plot.title = element_text(color="darkgrey", size=12, face="bold"),
axis.title.y = element_text(color="darkgrey", size=10, face="bold.italic"),
#axis.text.y = element_blank(),
axis.ticks.x = element_blank(),  # Hide labels
axis.text.x = element_blank(),
legend.title = element_text(face="bold"),
legend.position="bottom",
legend.background = element_rect(fill="lightgrey"),#Change legend box background color
plot.caption = element_text(color = "darkgrey", size=5)) +
scale_fill_brewer(palette="Set1")
all_fitc_patch_log10 <- plot_all_fitc_log10 + plot_annotation (
title = 'Intestinal permeability',
#subtitle = 'All fitc measured',
#tag_levels = 'A',
caption = 'VANCO = Vancomycin, BF = Breast-Feeding, FF = Formula-Feeding\n
FVT = Fecal Virome Transfer, SM = SM-buffer',
theme = theme(plot.title = element_text(hjust = 0.5, size=14, face="bold"),
plot.subtitle = element_text(hjust = 0.5, face = "bold.italic"),
plot.caption = element_text(hjust = 0.5, size=7,face = "bold")))
all_fitc_patch_log10
FITC_PATCH <- all_fitc_patch + all_fitc_patch_log10
FITC_PATCH
tbl1_gt
